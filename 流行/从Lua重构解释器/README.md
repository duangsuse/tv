# å‰è¨€


Luaæ˜¯ä¸€é—¨ç±»ä¼¼pyjsã€ä¸»æ‰“å°å·§çš„è„šæœ¬è¯­è¨€ï¼Œå®ƒæ”¯æŒJavaç¼–è¯‘ä¸é€šè¿‡çš„ `if 1==1 then class{BE='Pair',swap=()=>Pair(B,A)}` å’Œ `co:yield(Async)` ä¸€ç±»å‡½æ•°èŒƒå¼ã€‚é«˜åŠ¨æ€å’Œå®¢åˆ¶æ€§ï¼Œä½¿Luaè¢«è…¾è®¯å’Œæ€’é¸Ÿæ¸¸æˆå¼•æ“+OpenResty+OpenWRTæ‰€é’çï¼Œå¹¶æœ‰äº† [Luvit.io]/[MoonScript.org]/[YueScript.org] ç­‰è¿è¡Œæ—¶å’Œæ–¹è¨€ã€‚

Luaè¢« [Neovim](https://github.com/OXY2DEV/markview.nvim/blob/main/lua/markview/presets.lua),[conkyé…·HUD](https://conky.cc/lua),wireshark,Adboe,Androlua,AutoJS ç­‰Appä½œä¸ºé…ç½®å’Œè§„åˆ™å¼•æ“é«˜é¢‘è°ƒç”¨ï¼Œå…¶åœ°ä½å¾ˆåƒç»™JVMæ„å»ºapkçš„Groovyã€å…¶åç«¯æ¨¡æ¿EL & `@Spring(DSL)` ï¼Œä½†ï¼ŒLuaæ²¡å®‰å…¨æ¼æ´ï¼Œ[å®ƒç”šè‡³èƒ½è¿è¡Œåœ¨å†…æ ¸é‡Œ](https://github.com/luainkernel/lunatik)ã€[è·‘åœ¨å•ç‰‡æœºä¸Š](LuatOS.com)ï¼

å¯è§ï¼Œã€ŒLuaç”Ÿæ€ã€å¹¶éè—‰è—‰æ— åã€‚å¦‚æœè¯´å®ƒæ¯”pyjså·®åœ¨å“ªï¼Œé‚£å°±æ˜¯ `local doâ€¦end` å’Œæ•°ç»„å­—å…¸ç»“æ„è¾ƒå†—é•¿æ··æ·†ï¼Œä½†å…¶æ•ˆç‡å’Œå®Œå¤‡æ€§ï¼Œæ·±å—æ¸¸æˆå¼€å‘è€…ã€æ¶æ„å¸ˆçš„é’çã€‚

æœ¬ä¹¦æ˜¯ [ã€ŠLuaè§£é‡Šå™¨æ„å»ºï¼šä»è™šæ‹Ÿæœºåˆ°ç¼–è¯‘å™¨ã€‹ Â©2023 Manistein ï¿¥64](https://book.douban.com/subject/36280421/) çš„çŸ¥è¯†é¢„å¤‡ï¼Œ__ä»å‰åç«¯Cç®—æ³•å¼€å‘å¸¸è¯†ï¼Œå¯¼å‘PLT(å…ƒç¼–ç¨‹ç†è®º)å¸¸è¯†__ï¼›è§£æLuaæ‰€ç”¨çš„ç®—æ³•èŒƒå¼ï¼Œæ‰‹æ‰“ä¸€æ¯å°†ä»£ç å­—é¢è¯­æ„ï¼Œæ˜ å°„åˆ°jsåˆ—è¡¨å­—å…¸çš„æŠ“å¨ƒTreeWalkerã€‚

Luaå’ŒPyJSçš„å…ƒç¼–ç¨‹æŠ€æœ¯æœ‰è¿™æ ·çš„å¯¹åº”å…³ç³»ï¼š[NeLua.io]=Mojoã€[Luau.org]=TSC/Oxc/BabelJS.ioã€[LuaJIT.org]=[PyPyè‡ªä¸¾JIT](https://pybenchmarks.org/dont-jump-to-conclusions.php)ã€[metalua](https://github.com/fab13n/metalua/blob/master/README-parser.md)=[ESTreeğŸŒ¿ ğŸŒ±](https://tree-sitter.github.io/tree-sitter/playground)/IntelliJ PSI/`import ast` (å¸¦è¡Œå·è¯­æ³•æ ‘.py)ã€‚

è‹¥è¦é—®åœ¨Webä¸Šä½“éªŒLuaï¼Œæˆ–é…ç½®ç±»ä¼¼pyçš„å¼€ç®±å³ç”¨ç¯å¢ƒçš„æœ€å¥½æ–¹æ³•ï¼Œè¯·æ‰“å¼€[Fengari.js](http://fengari.io/)å’Œ[Luvit](#æ ‡å‡†å®‰è£…)ï¼Œå®ƒä»¬æä¾›äº†æ–‡ä»¶/æ ¼å¼/ç½‘ç»œIOåº“ã€‚

ä¸ºå•¥éè¦æ„å»ºLuaï¼Ÿ [CRuby,CPython,QuickJS](https://hellogithub.com/report/tiobe) çš„æºç æœ‰å•¥é—®é¢˜å—ï¼Ÿ å…¶å®ï¼Œ**æ— è®ºä½ æ˜¯æƒ³è®¤è¯†å½“ä»£å·¥ä¸šç•Œ DSL(interpreter)|VM|GC åŸç†ã€OSæˆ–OOPæ¶æ„æœ¬è´¨("å¿ƒæ™ºæ¨¡å‹")ï¼Œæˆ–æ˜¯åªåš[äºŒè¿›åˆ¶|é€†å‘](https://github.com/duangsuse-valid-projects/CoolTok)Mod|FFIæˆ–AOPè°ƒç”¨ç»‘å®šï¼ŒLuaéƒ½æ˜¯top 1%çš„æ¡ˆä¾‹ï¼ğŸ**

> â€œä¸šç•Œæ€»æœ‰ä¸¤æ´¾ç¨‹åºè®¾è®¡æ–¹æ³•ï¼Œä¸€æ´¾ç®€æ´çœŸè¯šï¼Œæ˜ç¡®ä¸å †ç Œç¼ºé™·ï¼Œä¸€æ´¾ç¹å¤ç©ºæ´ï¼Œè¿ç¼ºé™·è®¾è®¡éƒ½ä¸æ˜ç¡®â€”â€”Hoare, å¿«é€Ÿæ’åºä¹‹çˆ¶â€

éº»é›€è™½å°ï¼Œäº”è„è¶…å…¨ï¼Œæˆ‘åˆæ¬¡é˜…è¯»è®¡ç®—å™¨[subexpr()è§£æ](https://github.com/Tencent/xLua/blob/master/WebGLPlugins/lparser.c#L1069)æ—¶å°±å­¦åˆ°äº†ã€Œç§‘ç­çš„ã€ YaCC,LL1,[ANTLR+VSCodeå¼•æ“](https://www.cnblogs.com/dtux/p/14885606.html) ä¸ä¸€ä¼—[FPå‡½æ•°å¼]è§£æç»„åˆå­ä¸ä¼šæ•™ä½ çš„é€Ÿç®—æ³•ã€‚ æ­¤æ³•è¿˜å¯ç”¨äºç”Ÿæˆ [HTML.h1~h6 å¤§çº²æ ‘](https://wojs.org/HTMLs/deep.html)ã€[pyçš„ç¼©è¿›å—](https://t.me/dsuse/18843)([Cffiå¤´æ–‡ä»¶](https://github.com/duangsuse-valid-projects/Hachiko/blob/master/hachiko_bapu/funutils.py#L63))ï¼Œæœ¬ä¹¦éƒ½ä¼šå®æ“ â€”â€”å¦‚æœè¯´Lispå’Œå…¥æ¼”ç®—æ˜¯ã€Œè¯­è¨€ä¹‹é—´çš„è¯­è¨€ã€ï¼ŒLuaä¾¿æ˜¯ã€Œè¯­è¨€é‡Œçš„è¯­è¨€ã€äº†

è¿™æœ¬ä¹¦ä¸æ­¢å†™ç»™ã€Œç§°èŒã€çš„å¼€å‘è€…ï¼Œæ›´æ˜¯å±äºã€Œä¼˜ç§€ã€ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‚ ä¸€æ‹›é²œï¼Œåƒéå¤©çš„æŠ€æœ¯æ€»æ˜¯å­˜åœ¨ï¼Œä½†åªæœ‰è‡ªç”±æŒæ¡åº•å±‚é€»è¾‘ä¸Šçš„å­¦ä¹ èƒ½åŠ›ï¼Œæ‰èƒ½åœ¨å®ƒä»¬åˆç°æ—¶ä¾¿ä¸€è§å¦‚æ•…ï¼Œèƒ½ç©·å…¶å˜ï¼Œæ–°çŸ¥ä¸ç©·ã€‚ #ç å“²

å¦‚æœæ‚¨è¿˜ä¸ä¼šLuaï¼Œè¯·å¤šçœ‹ [js2Lua](https://js-to-lua.netlify.app/) å’Œ [ä¸­æ–‡APIæ–‡æ¡£](https://cloudwu.github.io/lua53doc/manual.html#6.1)ã€‚**æœ¬ä¹¦å¤§éƒ¨åˆ†é“¾æ¥éƒ½å¯è§†ä¸ºèµ„æ–™ç«™ï¼Œè€Œéå­¤ç«‹å¼•ç”¨æ–‡ï¼ˆåˆè¯»å»ºè®®æ‚¨å¿½ç•¥ï¼Œä½†ç¡®å®éƒ½æ˜¯æ²™æµ·æ·˜é‡‘çš„èµ„æ–™ï¼‰**ã€‚ å¯¹Javaerå’ŒPythonistaï¼Œæœ¬ä¹¦çš„å…ƒç¼–ç¨‹æŠ€å·§ä¹Ÿæ˜¯é€šç”¨çš„ã€‚ å¯¹åºåˆ—åŒ–/ä¾èµ–æ³¨å…¥/æ¥å£ç»‘å®šå’Œ `@è°ƒç”¨()` -ä¾‹å¦‚ Gson,ButterKnife,DeepCopy çš„å¹•åä»£ç å¥½å¥‡ï¼Ÿæœ¬ä¹¦æ›´é™„èµ äº†å®è·µæ–¹æ¡ˆã€‚

ç›®å‰ï¼ŒCLuaçš„æœ€æ–°ç‰ˆæ˜¯2024/1å‘å¸ƒçš„ Lua 5.4.7ã€‚Lua è¯ç”Ÿäºå·´è¥¿ PUC Rio å¤§å­¦ï¼Œè‡³ä»Šè¯­æ³•ä¸Šæ²¡ä»€ä¹ˆå˜åŒ–ï¼Œæˆ–è€…è¯´ï¼Œæ²¡py2to3é‚£æ ·é‡å¤§çš„é”™è¯¯ã€‚


>â€œç®€æ˜æ˜¯å¯é çš„å…ˆéªŒï¼Œä¸æ˜¯å¯é çš„ç¥­å“ã€‚â€”â€”Dijkstraï¼Œæˆ–è®¸å’Œä»£ç è‡³ä¸Šçš„LinusèŠä¸æ¥â€

2023æ˜¯Luaçš„30å²ç”Ÿæ—¥ã€‚å®ƒä¸ºä½•è€Œç”Ÿï¼Ÿ Tecgrafå®éªŒå®¤çš„ä¸‰ä½ä½œè€… Roberto Ierusalimschy, Waldemar Celes, Luiz Henrique de Figueiredo ä¸ºäº†å·´è¥¿çŸ³æ²¹å…¬å¸çš„æ•°æ®å‹˜æ¢å·¥ä½œï¼Œè®¾è®¡äº†DELå’ŒSol(è¥¿è¯­çš„Sun)ï¼Œè€Œä¸ºè®©Excelç±»å¤„ç†æ›´å¥½ä¸Cå…¼å®¹ï¼Œå…¨æ–°çš„LuaæŠŠJSONçš„ary|objæ··åˆæˆäº†tableï¼Œç”¨falseyä»£è¡¨nil (5"æ•°æ–‡è¡¨çœŸç©º")ï¼Œåˆå¤©ç”Ÿæ”¯æŒCå‡½æ•°ã€æ ‘æŒ‡é’ˆã€åç¨‹ï¼Œåªä¿ç•™5+3ç§ç±»å‹ã€‚

Luaè§£é‡Šå™¨æ˜¯å¼€æºçš„ï¼Œå…¶è¾“å…¥Luaè„šæœ¬å´æœ‰ä¸¤ç§å½¢å¼: loadstr|chunk ï¼Œå¯¹åº”ç€ lparser.c codegen å’Œ lvm.c bytecode è§£é‡Šå™¨ã€‚ æœ¬ä¹¦ä»…è®¨è®ºstrçš„å½¢å¼ï¼Œåœ¨æœ«å°¾ä¼šæ•™å¤§å®¶å®ç°"JSON-spgjiaå…­å˜é‡æ ˆæœº"å’Œåæ±‡ç¼–å™¨ChunkSpyçš„åŸç†ã€‚ å®ƒä¿©è¦†ç›–äº† JVM/Dalvik ART/Flash ruffle.rs çš„åŸºæœ¬æ“ä½œã€‚ ğŸ

é™¤äº†ä½œä¸ºAppã€MCã€ç½‘é¡µå°æ¸¸æˆå¼€å‘çš„åŸºçŸ³ï¼Œä»¥Luaä¸ºç¬¬ä¸€è¯¾çš„ã€Œcodegen/bin-hexã€æŠ€æœ¯è¿˜åº”ç”¨åœ¨[å®‰å“x86 armv7æ¨¡æ‹Ÿå™¨](https://www.zhihu.com/question/29851229/answer/104193305)ã€åŸºäºarmv8 MacOSçš„Rosettaè½¬è¯‘ã€ WebVM.io çš„WASMç‰ˆJVMå’ŒLinux(ffmpegçš„ä½œè€… Bellard.org ä¹Ÿåšäº†ä¸€ä¸ª)ã€libcçš„å‡½æ•°ä¾èµ–å›å¡«å™¨ `ld-linux.so $needNoChmod` ä¸Šï¼Œ

å“ªæ€•ä½ åªæ˜¯æ¸¸æˆç©å®¶ï¼Œä¹Ÿé€ƒä¸æ‰å¯¹CheatEngineå’Œé‡‘å±±æ¸¸ä¾ ã€å¤§åé¼é¼çš„â€œä»»åœ°ç‹±â€ Dolphin/Suyu.dev/[MednafenğŸµ](https://chiptune.app/browse/Demo%20MIDI/Voyetra%20Orchestrator) ä»¬çš„ä½¿ç”¨ã€‚ å¤ªé…·äº†ï¼Œ[ç§‘æŠ€å¹¶å¸¦ç€è¶£å‘³ğŸ¨](https://t.me/dsuse/20140)ï¼Œæˆ‘ä»¬ä¸€èµ·é€æ¸ç†è§£è¿™ä¸€åˆ‡å§ï¼ğŸ¤“ğŸ–•

# å¤§çº²ç¯‡

å’Œã€ŠLuaæ„å»ºã€‹æ¯”ï¼Œã€Šé‡æ„ã€‹çš„é¡ºåºå’Œç€é‡ç‚¹å·®å¼‚å¾ˆå¤§ã€‚ ä¸‹ä¸ºåŸç« èŠ‚å™äº‹ï¼š

1. è§£é‡Šå™¨çš„åŸºæœ¬æ¦‚å¿µï¼Œä¹Ÿå‘Šè¯‰ä½ è™šæ‹Ÿæœºå’Œç¼–è¯‘å™¨çš„è‚èƒ†ç›¸ç…§
2. Luaè™šæ‹Ÿæœºçš„æŠ½è±¡ï¼ŒåŒ…æ‹¬â€œå¸¦ç±»å‹çš„æŒ‡é’ˆâ€å’ŒæŒ‡ä»¤å¾ªç¯(CPU cycleæ˜¯1ç§’å‡ G?)ã€å†…å­˜åƒåœ¾å›æ”¶æœºåˆ¶ã€å­—ç¬¦ä¸²å’Œè¡¨ï¼Œè¿™ä¹Ÿæ˜¯Boostç­‰C++erçˆ±é€ çš„è½®å­ã€‚
3. Luaç¼–è¯‘å™¨å’Œè™šæ‹Ÿæœºå¦‚ä½•äº¤äº’ï¼Œå¦‚æœå®ƒä»¬æ˜¯defæˆ–classï¼Œè°ƒç”¨ç­¾åå’Œthiså˜é‡é›†é•¿å•¥æ ·ã€‚
4. Luaç¼–è¯‘å™¨ã€Œçº¯æ‰‹å†™ã€çš„è¯æ³•åˆ†æå™¨å’Œè¯­æ³•åˆ†æå™¨ï¼Œå¦‚ä½•è¾¹parseç€å°±æŠŠChunkå­—èŠ‚ç ç”Ÿæˆäº†ã€‚
5. Luaçš„å…ƒç¼–ç¨‹å’Œè®¾è®¡æ¨¡å¼ï¼ŒåŒ…æ‹¬å…ƒè¡¨ã€Userdataæ ‘æŒ‡é’ˆã€Upvalueé—­åŒ…ã€å¼±å¼•ç”¨è¡¨å’Œrequireæ¨¡å—
6. ä¸€ä¸ªä¿„ç½—æ–¯æ–¹å—å°æ¸¸æˆï¼Œå¦‚ä½•è¢«dummyLuaè§£é‡Šè¿è¡Œï¼Ÿ

æœ¬ä¹¦ä¸æä¾›å›¾è¡¨ï¼Œè€Œæ˜¯é€šè¿‡è‡ªé¡¶å‘ä¸‹ã€æ‹†åˆ†ä»£æ¢ã€æ¥å£å¤ç”¨çš„ã€Œå…ƒè¯­è¨€ã€ï¼Œå®šä¹‰ä¸‡ç‰©ï¼Œå°±åƒä¸Šé¢è¿™æ ·ã€‚

æœ¬ä¹¦ä¸èƒ½ä¸ºçº¸è´¨æ’ç‰ˆã€‚Webçš„æµå¼å¸ƒå±€+è¶…é“¾æ¥ï¼Œæ›´é€‚åˆå®ƒçš„ä¿¡æ¯å¯†åº¦ã€‚è®ºæ–‡é‚£ç§æ ¼å¼ï¼Œå¤§æ¦‚ä¹Ÿæ‰¿è½½ä¸äº†å¦‚æ­¤æ•°é‡çš„å¼•æ–‡ï¼ˆç¬‘ï¼‰

åœ¨æ˜¾ç¤ºæœ¬ä¹¦å¤§çº²å‰ï¼Œæˆ‘å¸Œæœ›æ‚¨è®¤çœŸè¯»å®Œè¿™4ç¯‡å¯¼è®ºï¼Œå†è¯•çœ‹ä¸‹è¿™3ä¸ªç©å…·ã€‚ è¿™äº›æ–‡ç« çš„ä½œè€…åœ¨å›½å†…Java/C#/JSçš„ç¼–è¯‘æœŸå’Œè°ƒä¼˜é¢†åŸŸæ˜¯ä½¼ä½¼è€…ï¼Œæœ‰çœŸçŸ¥ç¼è§ï¼Œäº¦å­—å­—ç ç‘ã€‚ä»–è€…ä¹‹çŸ³ï¼Œå¯æ”»ç‰ä¹Ÿã€‚

- [WASM MoonbitLang.cn ä¸»åˆ›å¼ å®æ³¢ä¾ƒç¼–ç¨‹è¯­è¨€å²](https://juejin.cn/post/7040037986699837453)
  - ReScript ä¹‹çˆ¶å¼ å®æ³¢åœ¨å‰ç«¯ä¸Šä¹Ÿå¾ˆå¼ºï¼Œèµ°çº¯å‡½æ•°è·¯çº¿ï¼Œä»–å¯¹ç¤¾åŒºæˆå‘˜å¾ˆå‹å–„ã€‚
  - **ä½†åœ¨æœ¬æ–‡ä¸­ï¼ŒæŠ±æ­‰ï¼Œæˆ‘ä¸å½“å¥½å¥½å…ˆç”Ÿã€‚** å‡¡äº‹éƒ½æœ‰ä¸¤é¢æ€§ï¼Œå‘æŒ¥ã€Œæ‹¿æ¥ä¸»ä¹‰ã€ï¼ŒæŒ‡å‡ºä»»ä½•äººçš„ä¸è¶³ï¼Œé‚£ä¸æ˜¯äººèº«æ”»å‡»ã€‚ ã€Œè®¡ç§‘ã€å°±è¦æœ‰ç‚¹å„¿ç§‘å­¦æ€åº¦ï¼Œå°‘ç‚¹å‚²æ…¢ç§è´§ã€‚ Linus,Timsortçš„ä½œè€…Peters,Bcachefs
- [RednaxelaFX å¦‚ä½•åŒºåˆ†è§£é‡Šä¸ç¼–è¯‘-å›¾æ–‡](https://www.cnblogs.com/LiPengFeiii/p/15459762.html)
  - Rå¤§çš„æ–‡ç« ï¼Œå§‹äºé¢œå€¼ï¼Œå¿ äºå“è¡Œï¼Œå¯æƒœ2020ä»¥åä¸æ›´æ–°ä¸­æ–‡è´´äº†ï¼›æ¯è§‚å…¶æœ­è®°ï¼Œæ–‡æ°”æ·‹æ¼“ï¼Œå­—å¥åˆ‡å®ï¼Œå›¾æ–‡å€çŸ£ã€‚
  - Rå¤§è™½ç„¶æ˜¯APIåº•ä¸‹ã€OSå±‚çš„äººæ‰ï¼Œå‚åŠ JDK.HotSpotçš„å¼€å‘ï¼Œå´æ˜¯æŠ€æœ¯æœ‰ç¾å¾·ã€è°ˆåæœ‰æ•™å…»ï¼Œéå¸¸æ•¬ä½©Appç¨‹åºå‘˜ï¼Œä»ä¸ç©ç†è®ºè‡ªæ°å´æ¯”C++è¿˜æ‹‰å®çš„é»‘é­”æ³•â€œåº”ç”¨é¢˜â€ï¼Œä»–é çœ¼å…‰æ¥é€‰æ‹©ã€‚ä»–è®²â€œç®€å•é¢˜é¢â€ï¼Œå¾€å¾€å´èƒ½æ¶ˆç­éš¾é¢˜é‡Œçš„å¤æ‚åº¦ï¼Œæ€»èƒ½ä¸€ç®­åŒé›•åœ°å†™ä¸œè¥¿ï¼Œè¿™æ˜¯ITé¢†åŸŸçš„é›†å¤§æˆä¹‹æ€æƒ³ã€‚
  - åˆ«äººå˜´é‡Œå¤§å‡ ç™¾è¡Œçš„æµæ°´å¸å’Œâ€œdemoâ€ â€œå¯è§†åŒ–â€ï¼ŒRå¤§æ€»èƒ½åœ¨[ä¸‰äº”è¡Œç™½è¯é—´](https://www.zhihu.com/question/35777031/answer/64575683)å°±ç‚¹ç ´å…¶åˆ©å¼Šå–èˆï¼Œè®©æˆ‘ä»¬çªç ´è¡¨è±¡å¼„æ‡‚æœ¯è¯­çš„å‰ä¸–ä»Šç”Ÿï¼Œå¾—æ¥å…¨ä¸è´¹åŠŸå¤«ï¼›ä»¿ä½›PLTè®¾è®¡å’Œç¼–è¯‘åŸç†åªæ˜¯å‡ å¼ Excelè¡¨å’Œå…¬å¼åµŒå¥—é‚£æ ·çš„æ˜¾å­¦ï¼Œå°±å¦‚åŒæŠŠé«˜æ•°æ‹¿æ¥ç­‘å±‹èˆ¬ä¸¾é‡è‹¥è½»ã€‚ å…¶â€œåŠŸåŠ›â€ä¹‹æ·±ã€â€œåŠŸåˆ©â€ä¹‹æµ…ï¼Œä¸è¨€è‡ªæ˜ï¼Œä»–åƒå­¦å®¶è£…è®¾è®¡å‡ºèº«çš„Vueå¤§ï¼Œä»¤æˆ‘ç­‰â€œä¸“å®¶â€æ±—é¢œã€‚ <a id=jmpJIT>å…³äº</a> [å¦‚ä½•JITåŠ é€Ÿ](https://zhuanlan.zhihu.com/p/610720287) (x86 ABIæ²¡åŸºç¡€å¯ç®€è¯»ï¼š[è·³ç€çœ‹å°±å¤Ÿäº†](https://bxtkezhan.github.io/post/tutorial_003/)), çœ‹å®Œèƒ½çŒœåˆ° Diane Silk dress costs $89 æ˜¯ä¸ºå•¥ğŸ˜‚
- [ç¾å›¢æŠ€æœ¯æ²™é¾™ï¼šJVM -O3ç¼–è¯‘ä¼˜åŒ–ï¼Œä»forå¼€å§‹è¯»](https://tech.meituan.com/2020/10/22/java-jit-practice-in-meituan.html)  ([å¯å¯¹ç…§@sysprogçš„Cè¯­è¨€åŒ–ç®€æ¡ˆä¾‹](https://hackmd.io/@sysprog/c-compiler-optimization?type=view#:~:text=Loop%20Optimizations))
- [HW-PLLab æœ±å­æ¶¦è°ˆç±»å‹æ£€æŸ¥å…¼æ¨å¯¼](https://zhuanlan.zhihu.com/p/634217295) (â€œæ•°å­¦â€å…¬å¼çš„éƒ¨åˆ†ä¸ç”¨çœ‹ï¼Œ[æœ¬æ–‡](#å­ç±»å‹æ–­è¨€)æœ‰è¦†ç›–)
- [æ–‡è¨€ç¼–ç¨‹è¯­è¨€](https://wy-lang.org/) (ç±»ä¼¼ç”ŸæˆPDFçš„PostScriptï¼ŒåŸºäºä¼ å‚æ ˆï¼Œéš¾ç‚¹è¿˜æ˜¯åœ¨IDEå°è£…ä¸è®¾è®¡ç¾å·¥)
- [ä»£ç ç½—å¡å¡”](https://rosettacode.org/wiki/Guess_the_number/With_feedback#Rust)ï¼ [ç‰¹æ„Ÿå…´è¶£çš„ä»£ç æ®µ,è¯·å¯è§†åŒ–ç¼–è¯‘](https://godbolt.org/)-[æˆ–è§£æ](https://astexplorer.net/)ã€‚ code.golf æ˜¯è®¤è¯†è¯­è¨€å·®å¼‚çš„å¥½æ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿå¯å½“[OJèµ›](https://www.freecodecamp.org/learn/rosetta-code/rosetta-code-challenges/execute-brain)-[OI.wiki](https://oi-wiki.org/intro/what-oi-wiki-is-not/) æ¥ç”¨ã€‚
  - æ¯”helloworldæ›´æœ‰è¶£çš„æ˜¯ï¼Œå‰ç«¯ Counter(n=1), [fakeJSON.data](https://www.jsonplaceholder.org)+component-party.dev; åç«¯ EchoServer, åŠ¨ç‰©å‡ ä½•OOP/ç»„åˆ, lsTree+sqlGrepr
  - æœ€å¼ºæ–‡æ¡£åœ¨ [DevDocs](https://devdocs.io/vue~3/api/composition-api-setup)+[é€ŸæŸ¥è¡¨](https://speedsheet.io/s/java?q=date#LjyM), [QuickRef](https://quickref.me/rust.html) devhints.io, cht.sh  tldr.sh
  - æˆ‘æ›¾ç”¨8ç§ä¸åŒèŒƒå¼çš„è¯­è¨€[å†™CSV](https://wojs.org/Others/FillTemplate)æˆ–å››åˆ™([ç”šè‡³SQL](https://duangsuse.github.io/tv/é»‘äº†/db.htm#:~:text=SQLite%20ç”šè‡³èƒ½),["Swagger"OpenAPI](https://github.com/duangsuse-valid-projects/GeekApk/blob/master/geekapk_v1b_api.geekspec))parserã€[è´ªåƒè›‡](https://duangsuse.github.io/tv/æ¸¸æˆæ—¶é—´/è´ªåƒè›‡/?v=0.js)å…¼[2048](https://duangsuse.github.io/tv/æµè¡Œ/2048.htm?é…0%287,7,2,128%29;doc.body.style.userSelect=%60none%60;cfg.åŠ¨æ„Ÿ=1)ã€[Desmosè§¦å±ä¹ä¸ç‰ˆğŸ¨](https://wojs.org/HTMLs/xy/xy.html)è¿™ç§ç®€å•ä»»åŠ¡ï¼Œåˆ«æ€•æ¨å€’é‡æ¥ï¼Œé‡æ„æ˜¯Vueå¤§é‚£ç§æ¶æ„å¸ˆçš„æ—¥ç¨‹ã€‚ (å°ä½œä¸š:[DFSæ­¥éª¤å¯è§†åŒ–](https://clementmihailescu.github.io/Pathfinding-Visualizer/#),ã€Šå¹¿åº¦ä¼˜å…ˆçš„æŸ“è‰²ï¼Œä»ä¸‹é¢çœ‹ï¼Ÿä»ä¾§é¢çœ‹ï¼Ÿã€‹)
  - [æ—¥è¯­åˆ†è¯å™¨](https://wojs.org/HTMLs/Tokenizer_examples)ã€[äººè„¸æ»¤é•œ](https://duangsuse.github.io/tv/å‚åŠ¨ä¹‹ç”»/æ–œçœ¼/base)(ç§»é¼ æ ‡æ—¶ç»˜åˆ¶)ã€[å›¾æ–‡æ¨¡æ¿](https://wojs.org/HTMLs/YounthLearn)(åŒç›®å½•å…±3ç§)ã€[FFTå¯è§†åŒ–](https://t.me/dsuse/18964)ã€[å¿«æ’ å½’å¹¶ visualize](https://duangsuse.github.io/mkey/making_reco/#sorts3)ã€[baseNç¼–ç è§£ç ](https://t.me/dsuse/18917) ä¹Ÿæ¯”å¤§å®¶æƒ³çš„ç®€å•ï¼Œå°±çœ‹æ‚¨æ•¢ä¸æ•¢ä¸Šä¹ä¸ç‰ˆã€‚
  - å–œæ¬¢OIã€CTFã€é»‘å®¢æ¾çš„jsäººå¯æ¶‰çŒ[è¿™ç¯‡æ¸¸è®°](https://blog.hanlin.press/2021/01/project-nano-official-writeup/)ï¼Œç¨‹åºå‘˜çš„æ—¶ä»£ï¼Œå¤§æ¦‚æ¯”1024èŠ‚ã€è½¯è€ƒã€æŠ€æœ¯é„™è§†é“¾ã€35å²æ·˜æ±°è®ºä¸°å¯Œä¸€ç‚¹å„¿ã€‚ å€’ä¸å¦‚è¯´ç¼–ç¨‹æ¯”æ•°å­¦æ›´åƒã€Œå…ƒå­¦ä¹ ã€
- [è‰èŸ’å’Œzhpy](https://www.grasspy.cn/zwdocs/grasspy-bible/chapter16_monkeypatch/)ã€ [ä¸€ä¸ªOIç”Ÿçš„Kotlin:kamet](https://mivik.moe/2020/tech/kamet-basic-implementation/)
- è¯»å®Œæœ¬ä¹¦åï¼Œæ‚¨å†å…³æ³¨å›½å†…å°‘æ•°çš„ä¼˜ç§€å…¬çŸ¥ï¼Œä¾¿æœ‰æ›´æ·±çš„ç†è§£ï¼š  é˜®ä¸€å³°(åŸç»æµåšå£«,å°¤é›¨æºªåŸå®¤å†…è®¾è®¡) å»–é›ªå³° äº‘é£ é™ˆçš“ é¸Ÿå“¥ å¼ é‘«æ—­CSS, ç‹å  [â€œæ¸©èµµè½®â€ä¹‹vczhè½®å­å“¥](http://www.cppblog.com/vczh/category/6824.html) Barretæé– ç¼–ç¨‹éšæƒ³ clowwindy(SSRçš„åŸä½œ) [Conmajiaè¯‘DNN](https://www.cnblogs.com/conmajia/p/annt-feed-forward-fully-connected-neural-networks.html)
- *è¿™é‡Œè¯´çš„ä¼˜ç§€ï¼Œä¸æ˜¯Bç«™ç¼–ç¨‹å¨±ä¹åœˆã€ŒJavaä¹‹çˆ¶ä½™èƒœå†› Cçˆ¹è°­æµ©å¼ºã€å“¦*

>â€œå¦‚æœMarkdownå’ŒYAMLéœ€è¦æœ‰æ·±åº¦è§£è¯»çš„è¯ï¼Œé‚£å°±ä¸éœ€è¦å®ƒä»¬äº†â€ â€”â€”æœ€æœ‰ã€Œæ½œåŠ›ã€çš„çŸ¥è¯†ï¼Œæ€»æ˜¯æ‰€è§å³æ‰€å¾—çš„ï¼Œå› ä¸ºè¯­è¨€åªæ˜¯ä¸ªè½½ä½“ï¼Œå”¯å¿ƒæ€æœ‰é›…ä¿—ä¹‹åˆ«ã€‚ è¯»ä¹¦æ—¶è‹¥ä¸€äº›ç« èŠ‚ä¸é‚£ä¹ˆæ˜“è§ï¼Œä¸å¦¨å¤šè¯»å‡ ä¸ªé“¾æ¥ï¼Œå†å¾…å‡ å‘¨ä½ ä¸”çœ‹ä»–ã€‚
><br> <br>  è°ˆç‚¹[åŠŸåˆ©ä¸»ä¹‰](https://www.zhihu.com/question/544112523/answer/2586209720)å’ŒçŸ¥è¯†ä»˜è´¹ç¬‘è¯ï¼šLinuxå¯è´­ä¹°ç”¨æˆ·æ›´åå¡ï¼Œé¦–å……6å…ƒèµ é€ç»ˆç«¯çš®è‚¤ï¼Œé»„é‡‘ä¼šå‘˜è§£é”bashrcé…ç½®â€¦â€¦
><br> æœé”™äº†å¤§ä½¬ï¼Œä½ çš„çŸ¥è¯†é¢ä¼šäº‹å€åŠŸåŠã€‚åœ¨è¿™æ ·ã€Œå»¶è¿Ÿæ»¡è¶³ã€çš„å†…è€—ä¸­çœŸçš„æƒ³å¾—æ˜ç™½ï¼Œå¾ˆä¸å®¹æ˜“ï¼Œå¤§å¤šæ•°äººå­¦åˆ°äº†åˆ«äººçš„å…«è‚¡ã€å´å¿˜ä¸æ‰ä»–è‡ªå·±ä¹Ÿä¸å¾—è¦é¢†çš„æœ¯è¯­ã€‚<br> <br>  æœ¬ä¹¦æ˜¯æˆ‘5å¹´å”¯ä¸€çš„ç§¯ç´¯ï¼Œå¸Œæœ›æ‚¨å¶å°”ä¹Ÿèƒ½å¤šè¯»ä¸¤éï¼Œä¸ä¸ªäººé£æ ¼çµæ„Ÿç»“åˆï¼Œæ–¹èƒ½æ‚Ÿå‡ºAppå’Œåº“ä»£ç çš„æ›´ä½³å®è·µã€‚æ è‹—åŠ©é•¿çš„äº‹å„¿ï¼Œå¯è¦ä¸å¾—ã€‚ #ç å“²

æŒ‰Ctrl+Fæœç´¢æ‰€æœ‰tag: #ç å“² #ç å²

## æ ‡å‡†å®‰è£…

```sh
mkdir bin; cd $_
#å¦‚ä½•æ·»åŠ PATH.: sed "s@.local/bin/:@\0$HOME/bin:@" -i .bashrc
#sudo rm /usr/bin/lit #LLVMçš„æµ‹è¯•å¥—ä»¶ä¸LuaåŒ…ç®¡ç†é‡åï¼Ÿåˆ 

#PowerShell -NoProfile -ExecutionPolicy unrestricted -Command "[Net.ServicePointManager]::SecurityProtocol = 'Tls12'; iex ((new-object net.webclient).DownloadString('https://github.com/luvit/lit/raw/master/get-lit.ps1'))"
curl -L https://github.com/luvit/lit/raw/master/get-lit.sh | sh
ls -Llh ./{lit,luvi,luvit} /bin/$0
lit install  er2off/class lil-evil/smoldb SinisterRectus/sqlite3 creationix/coro-postgres creationix/weblit

# æˆ‘ä»¬å¯ä»¥æ¯”è¾ƒä¸‹Luaåˆ°åº•æœ‰å¤šå°ï¼š
u=$(echo /bin/{lua,luajit,ruby,python,php,node,rustc})
ls -Llh $u
ldd $u|ruby -e 'puts ARGF.read.gsub(/ => (.*lib\/.*?) \(.*?\)/){"\t"+`du -h $(readlink -f #{$1})`.split[0]}'|grep -v ')$'
```

<details><summary>æ˜¯LLVMçš„0.5%ï¼</summary><pre>
/bin/lua: 300K
/bin/luajit:
	libluajit-5.1.so.2	572K
/bin/ruby:
	libruby.so.3.0	3.5M
	libgmp.so.10å¤§æ•´æ•°	664K
/bin/python:
	libpython3.12.so.1.0	6.2M
	libz.so.1è§£å‹åº“	100K
	libreadline.so.8è¡Œç¼–è¾‘REPL	336K
/bin/php: 21M
	libicudata.so.75ä¸‡å›½ç 	30M
	libpcre2-8.so.0æ­£åˆ™	632K
	libc.so.6	2.0M
	libstdc++.so.6	22M
	libgcc_s.so.1è½¯æµ®ç‚¹	896K
/bin/node: 59M
	libuv.so.1å…çº¿ç¨‹IO	204K
/bin/rustc:
	librustc_driver-074e7ea67172ca5c.so	73M
	libstd-80e3b149c7ec451b.so	8.1M
	libLLVM.so.18.1	129M
</details>


æ ¸å¿ƒç¤¾åŒºåº“ï¼š
- [Orbit MVC](https://keplerproject.github.io/orbit/) æˆ– [Restyå¹³å°](https://moonbingbing.gitbooks.io/openresty-best-practices/content/openresty/response.html)-è‡ªå¸¦Redis
- [Discordia](https://github.com/SinisterRectus/Discordia/blob/master/libs/utils/Color.lua#L43) ç»„è£…äº†ä¸€å¤§å †toolï¼Œæ¥å°è£…èŠå¤©æœºå™¨äºº
- LuatOS æ²¡æœ‰çº¿ç¨‹åç¨‹åŒæ­¥å¼‚æ­¥ï¼Œè°ƒ[Task](https://wiki.luatos.com/luaGuide/luatask.html)å°±å¤Ÿäº†
- [pl+itertools](https://stevedonovan.github.io/Penlight/api/manual/02-arrays.md.html) `Cat = class(); function Cat:say()end`
- [Moses FP](https://yonaba.github.io/Moses/) `M.sum(M.range(100))`
- ğŸ“¦[LPEG DSL](https://luyuhuang.tech/2020/06/24/lpeg.html#lpeg) `cvar=(l.alpha + P'_') * (l.alnum + P'_')^0; list=e=>e * (',' * e)^0`
  - **æ¯ç®—æ³•åªæœ‰1ç§ best practice**ï¼Œè¯·Ctrl+F PEG ï¼Œæœ¬æ–‡æœ‰åœ¨çº¿è¯•ç©çš„æ›´å¥½ç‰ˆæœ¬ï¼Œè¿™æ®µåªæ˜¯è¯´æ˜ã€ŒåŒä¸šåŠ¡å¯å°è£…å‡ºNç§ä¸åŒå†™æ³•ã€â€”â€”[ä¾‹å¦‚Kotlinç‰ˆå°±å¤æ‚æ›´å¤š](https://wojs.org/Others/essay-kotlin-parser)ï¼Œè¯·å¤šè§¦ç±»æ—é€š #ç å“²
- ğŸ“¦[cJSON](https://blog.95id.com/lua-json) `luvit -e 'require"json"'` ä¾¿[åŸºäºä»¥ä¸ŠPEG](https://github.com/LuaDist/dkjson/blob/master/dkjson.lua#L648)
- ğŸ“¦WebLit [socket](https://alexarjing.github.io/2016/12/08/chapter16/)ï¼ŒåŸºäºå›è°ƒå¼ `uv.new_tcp()`: `#ask luvit net.createServer tcp echo, with nc`
- [sql](https://scilua.org/ljsqlite3.html) `db=require("sqlite3").open(""); x=db:prepare[[SELECT 1+?, 3]]:bind(2):step()`
- [OpenDAL](https://opendal.apache.org/docs/python/opendal.html#usage) `op=fs.operator.new("fs",{root="/tmp"}); op:write("a.txt","hello world")`

ä»¥ä¸Šä¸åŒ…å«ç±»VBAåµŒå…¥å¼åº”ç”¨ã€‚æœ¬ä¹¦ä¸è¿‡åº¦å¯¼åŒ…ï¼Œä»…å±•ç¤ºLuaè¯­è¨€åŠŸèƒ½çš„å®Œå¤‡æ€§ï¼Œæ‚¨å¯ä»¥è‡ªè¡Œæœç´¢APIæ–‡æ¡£åšdemoã€‚

è‹¥æ‚¨è¿˜æ²¡æœ‰ç§‘å­¦ä¸Šç½‘ï¼Œç¼–è¯‘ä¼šå¡æ­»ã€‚å»ºè®®ç”¨ Clash App + Proxychains å…¨å±€ä»£ç†ï¼Œæ—¥ç”¨éª‘å¢™å®‰å“èµ›é«˜ï¼

```sh
#.: sudo bash
cat>socks <<EOF
cat>~/proxychains.conf <<OK
strict_chain
[ProxyList]
socks5 \$(getent hosts ipr|awk '{print \$1}') 10808
OK
export LD_PRELOAD=/usr/lib/libproxychains4.so
proxychains -f ~/proxychains.conf  bash
EOF
cat>/etc/udev/rules.d/99-usb.rules  <<OK
ACTION=="add", SUBSYSTEM=="usb", RUN+="/bin/sh -c '(sleep 2;eval \$(base64 -d<<<c2VkIC1FaSAicy8uKiggaXByKS9gaXAgcnxoZWFkIC1uMXxwY3JlZ3JlcCAtbzEgJ2RlZmF1bHQgdmlhIChcUyopJ2BcMS8iIC9ldGMvaG9zdHMK))& '"
SUBSYSTEM=="usb", ATTR{idVendor}=="2001", MODE="0666"
OK

echo æ‰“å¼€ç»ˆç«¯ . socks å³è”ç½‘ï¼Œæ’æ‹”æ•°æ®çº¿è‡ªåŠ¨é‡è¿
```

## Lua1~5è¯­æ³•çº§æ”¹è‰¯

è·Ÿç€Luaä½œè€…çš„è„šæ­¥å–µä¸€çœ¼ã€Œé—­åŒ…ã€ã€Œå¯¼åŒ…ã€ç­‰ç‰¹æ€§å§ï¼Œè®¾è®¡ç‚¹éƒ½æœ‰ã€Œæ€§ä»·æ¯”ã€ï¼Œæˆ‘ä¼šå°½é‡æ•™å¾—0çŸ¥è¯†èƒŒæ™¯ï¼Œå°±åƒé—²èŠã€‚ æ›´åŠ æœ‰è¶£çš„ç»†èŠ‚ï¼Œç‹¬ç«‹ç« èŠ‚ä¼šå¼€è®²ã€‚

- 1.1 VMä¼˜åŒ–tableæ„é€ å™¨({}å­—é¢)
- 2.1
  - å…è®¸è¿ç®—ç¬¦é‡è½½ã€å…ƒè¡¨Dundersï¼Œå¦‚ (`new Proxy{}{_index} => {}.__proto__`) ä»¥ç«äº‰Java OOP
  - `Grades{8.5, 6.0, 9.2; name="John", major="math"}` æ¶ˆç­äº† `@()ï¼Œ@[]å’Œ@{}` -Kotlinå…ƒç»„æœ€åˆä¹Ÿæ˜¯ `1to 2 æ¶ˆç­äº† #(1,2)`
- 2.5 stråº“æ”¯æŒä¼ªæ­£åˆ™ gsub,find (å®ç° grep AWK)
- 3.1
  - VMå°è¯•å¯„å­˜å™¨(=å±€éƒ¨å˜é‡)åŒ–
  - æ„é€ å™¨çš„ `{[10*x+f(y)]=47}`
  - å¼•å…¥äº† Context *Lï¼Œå¯æ²™ç›’å¹¶è¡Œå¤šä¸ªä¸Šæ–‡ï¼Œå¢å¼º ldebug ä»¥ç«äº‰Javaå¤šçº¿ç¨‹
  - å­—é¢ `sum=A=>(B=>A+B)` ç­‰æ•ˆäº FP `sum=A=>((upA,B)=>upA+B).bind(0,A)`, å³ **upvalue/upv, æœ¯è¯­ä¸º nonlocal/cell var**
  - nonlocal ä»¨æ€ªç™–ï¼š Javaé‡Œcellå¿…é¡»æ˜¯ effective finalï¼Œpyé‡Œ ` [(lambda:x) for x in "abc"][0]()` æ˜¯cï¼Œ `sum=A=>` è¿”å›(close)å‰Aåœ¨æ ˆä¸Šï¼Œä¹‹åå°±ä¸ä¸€å®šäº†ï¼Œæˆ–è®¸åœ¨å †é‡Œï¼Ÿ
  - Ktç”¨ `val upA=IntRef(0)` æ”¯æŒmutæ•è·ï¼ŒVueç”¨æ›´çµæ´»çš„ `x=ref(0).value, watch(()=>x)` ï¼ŒRustçš„ FnOnce FnMut é‡è½½trait..å°±æ›´å¤æ‚äº†
  - ä»–ä»¬å…¶å®æ˜¯æƒ³ä¼˜åŒ– `class sum(A=0) { invoke(B=0) { A+=1;return this.A+B } }` è¿™æ ·çš„å˜é‡é›†å…³ç³»ã€ŒLex Scopeã€ï¼Œpyjs åœ¨thiså’ŒåŸå‹é“¾ä¸Šå„æœ‰å„çš„å‘ã€‚
  - å…¶å® call stack ä¹Ÿæ˜¯å‘ã€‚threadå¼‚å¸¸è¿”å›æ ˆã€coroå›è°ƒé“¾è¡¨ï¼Œå½“åç¨‹+å¤šçº¿è°ƒåº¦æˆäº†ä¸»æµï¼Œä½ ä¼šå‘ç° åç¨‹=é—­åŒ…+switch(var è¯­å¥å·)ï¼š â€œå±€éƒ¨åˆ†é…â€è¿˜å­˜åœ¨å—ï¼Ÿ
- 4.1 æ”¯æŒfalse, æ²™ç›’å·²è§£å†³"GIL"é—®é¢˜
  - ğŸ¤“ï¼š è°ƒç”¨æ ˆæ‰ä¸æ˜¯å‘ã€‚KtJSç”¨å›è°ƒé“¾è¡¨å®ç°ã€Œæ·±å…ˆæ±‚å€¼ã€å’Œfinally/deferåŸŸï¼Œè€Œå†…æ ¸sched.cã€LuaVMå’ŒGoç”¨æ›´å¥½å¯»å€çš„4Kæ ˆï¼Œè¿™æ˜¯å–å†³äºTaskçš„å¹¶å‘ä¸ªæ•°ã€é€’å½’å±‚æ•°ï¼Œ appå±‚éƒ½åç¨‹ï¼Œæ¡†æ¶å¼•æ“è¿˜éœ€è¦ç”¨çº¿ç¨‹æ± å°±æˆäº†å•Šï¼ å°±åƒpyå’ŒGTKéƒ½æ˜¯Rcå¼•ç”¨è®¡æ•°ï¼Œä½†mallocéœ€è¦å†…å­˜æ± å•Š
  - ğŸ˜“ï¼šæœ‰é—®é¢˜çš„æ˜¯ã€ŒåŒæ­¥å¼‚æ­¥ã€æ’•è£‚ã€‚æ²¡äººæè¿™å››ä¸¤æ‹¨åƒæ–¤çš„ `curl.then(unzip).then` å’Œ `Promise.all([])` å°è£…ï¼Œ3å±‚å›è°ƒè¿˜ä¸æ˜¯åœ°ç‹±ï¼Ÿ`thread2.join` åˆæ˜¯å“ªåƒ `make -j2`ï¼Ÿ å®‰å“ä¸Š `sleep(1s)` ä½ æ•¢è°ƒï¼Ÿä¸å¾—å’Œjs.alerté‚£æ ·å¡æ­»ã€‚ æ™¯å¾·é•‡å‡ºæ¥çš„ï¼Œç‰›Bè¯å„¿å¤ªå¤šæ¬ å°è£…äº†ï¼Œä¸»å¾ªç¯ï¼Œå…³æˆ‘ä½•äº‹ã€‚newä¸ªå›è°ƒï¼Œç ´äº‹çœŸå¤šã€‚
  - ğŸ¤“ï¼š
  - [Schemeè§£é‡Šå™¨](https://www.yinwang.org/blog-cn/2012/08/01/interpreter)æ²¡åç¨‹å’Œcellçš„æ¦‚å¿µï¼Œæ¯•ç«Ÿå¥¹ä»ä¸è€ƒè™‘ä¼˜åŒ– `async()=>await(rand()? 'é—ªç”µäº”è¿é­' : sleep(1))`, `sum=A=>(1==1)? (B=>A+B) : cry('å¤©å¡Œäº†,CPUèƒ½ç®—é”™?')`, `f=obj.f; f()//æ‰¾ä¸åˆ°åŸå‹é“¾`
  - ğŸ˜„ï¼šåœ†æ‹¬å·ç¥æ•™ï¼Œå•¥æ—¶å€™å˜åé¢å…¸å‹äº†ï¼Œnerdä¸å–œæ¬¢ã€Œç®€æ´butä¸ç®€å•ä¸scaleã€çš„ä¸œè¥¿å—ï¼Ÿ ä½ ä»¬å–œæ¬¢ç•™çœŸå¿ƒæ±‚çŸ¥çš„è¯»è€…åœ¨æ·±å¤œå‡Œä¹±
  - ğŸ¤“ï¼š **make it work, code it work, then make it fast. ä¸è¦çœ‹ä»–æ€ä¹ˆå†™ï¼ŒçŒœä»–æ€ä¹ˆæƒ³ã€‚æœ‰whyæ‰çœŸæ‡‚howï¼Œæœ‰reasonçš„å¼€å‘è‡ªç„¶correct** #ç å“²
- 5.0 åºŸé™¤JVMå¼çš„å‚æ•°æ ˆï¼Œç”¨å¯„å­˜å™¨åšè¿ç®—ï¼Œå‡½å‚APIæ²¿ç”¨pushï¼Œä¹Ÿå³ `luaK_dischargevars` ç®—æ³•ä¼˜åŒ–
- 5.1 åå¹´å‰çºªå¿µç‰ˆ
  - `a,b = ...`; VA_ARGS æ— éœ€{}æ¥æ¨¡æ‹Ÿï¼Œkwargå’Œjsä¿æŒä¸€è‡´
  - `(--)?[==[ [[heredocä»»æ„åµŒå¥—&å¤šè¡Œæ³¨é‡Š]] ]==]` Wikiè¯­æ³•
  - ğŸ˜“ï¼šåˆšè¯´ã€Œæ·±å…ˆæ±‚å€¼ã€ï¼Ÿ å“¦å¯¹ï¼Œ `eval('1+(2*3)')` æ˜¯æ·±å…ˆæ”¹æ•°(æ”¹æ ‘)ï¼Œæœ‰ç”¨ `['farg'].map((k,i)=>env[k]=arg[i])` å®ç°ã€ŒDynamic Scopeã€
  - ğŸ¤“ï¼šCSç§°å…¶ã€Œæ ‘çš„ååºéå†ã€ã€ŒSDTä¹‹ç»¼åˆå±æ€§ã€ï¼Œå¿«æƒ³æƒ³æœ€æœ‰è¶£çš„ç‚¹ï¼bashå’ŒLuaé‡Œ `0&&print(åŒ…æ‹¬or)` æ˜¯ç©ºï¼Œè¿™å«ã€Œä¼ åè°ƒç”¨ã€æ±‚å€¼åºã€‚Lispçš„ `[cond (A) çˆ½ (B) æ›´çˆ½]` å‡½æ•°å°±æ˜¯é è¿™æ¥æ¨¡æ‹Ÿå®
  - ğŸ˜“ï¼š `@autoclosure` å˜›ï¼Œä½æ€§èƒ½ã€‚ `IO ()` Monad å°±æ˜¯æ‹¿å›è°ƒé“¾è¡¨ä¼ªè£…çº¯å‡½æ•°-ç¾å…¶åæ›°fmapï¼Œå’ŒLispçš„CPSåŠæ–¤å…«ä¸¤ *ï¼ˆæ³¨ï¼šè¯»ä¹¦é‡åˆ°ç”Ÿè¯æŠ˜ä¸ªè§’ï¼Œå¾ˆå¿«è¦è·³è½¬å›å¡«çš„ï¼ï¼‰*
  - ğŸ¤“ï¼šç­‰ç­‰ï¼Œ `['farg'].map{env.k=v}` ? åº”è¯¥æ˜¯åœ¨åˆ†è¯æ—¶å°±ææ¸…fargæ˜¯$1å·å±€éƒ¨orå…¨å±€"farg"ï¼Œä»¿ä½›æœ‰Næ¡çº¿æŠŠ'farg'ä»¬çš„slotéƒ½è¿åœ¨ä¸€èµ·ï¼Œåƒç”µè·¯é‚£æ ·ç›´ç™½ï¼
  - ğŸ˜„ï¼šæ²¡é”™ï¼Œseal(çš„KV)æ‰å¯ä»¥ç¼–å·ä¼˜åŒ–ã€‚ `{k:v}` çš„å‡ºç°è®©ç¼–è¯‘å™¨å¼€å‘æ›´ä½å¹¼äº†ï¼Œã€Œè§£é‡Šå™¨å¼€é”€ã€å…¶å®æ˜¯KVå’Œé€’å½’è¿™äº›é«˜å±‚ç»“æ„çš„å¼€é”€ã€‚ å˜é‡ååªæ˜¯åŠ©è®°ç¬¦ï¼Œmallocåœ°å€/æ ˆåˆ†é…/åç§»ç¼–å·/retåœ°å€ æ‰æ˜¯æœ¬è´¨ã€‚å¦‚æœè§£é‡Šå™¨éƒ½ç”¨é“¾è¡¨æ‰‹å†™Map.getç¦æ­¢setï¼Œæ²¡äººä¼šå†æ‹¿å‡½æ•°ä¼ å‚å½“ä¼ {}ã€‚è¿™å°±æ˜¯Luac
  - ğŸ¤“ï¼šBingo~ Lambdaå…¥æ¼”ç®—ç§°å…¶ä¸ºå˜é‡åçš„ a-ç­‰ä»·ã€ b-å½’çº³åŒ–ç®€ã€‚ [ã€ŠThe little schemerã€‹](https://www.hugchange.life/posts/202306_the_little_schemer.html) Î·-å˜æ¢åˆ™æš—ç¤ºäº† pointÂ·free style å‡½å‚é¢—ç²’åŒ–ï¼Œå¯ä»¥è¯´æ˜¯FPçš„æ­£ç»Ÿäº†ï¼ŒHaskellå¼•å…¥äº†è¯­æ³•ç³–å’Œç±»å‹åŒ¹é…ï¼Œæ¶‰çŒä¸€ä¸‹ã€‚
  - ğŸ˜“ï¼š *å“‡ï¼Œè¿™ä¸ªblogçš„æ’ä»¶å¥½é…·ï¼æ‚¬åœåœ¨åœ†æ‹¬å·ä¸Šè¯•è¯•çœ‹ï¼ ç‚¹å‡»å·¦ä¸‹è§’ï¼Œé‚£ä¹Ÿæ˜¯Sè¡¨è¾¾å¼å‘¦* ï¼Œ[æˆ‘æ‹¿draggableè¯•å†™è¿‡ï¼Œå¤±è´¥äº†](https://github.com/duangsuse/mkey/blob/main/lice.js#L188)
  - ğŸ˜„ï¼šæˆ‘æ•¢è¯´å›½å†…80%çš„FPä¹ƒè‡³ITç†è®ºäººè¿½æ±‚çš„å°±æ˜¯è¿™ç§ã€Œä¸æ˜è§‰å‰æ„Ÿã€ï¼Œä½ çœŸæŠ½ä¸å‰¥èŒ§ï¼Œä»–ä»¬ä¾¿æ•£äº†ã€‚ â€œçº¯â€å°±åƒRusté‚£æ ·ç»™ä½ ç”»äº†ä¸ªé¥¼ï¼Œä¸€æ—¦ä½ ææ‡‚åå´æ²¡æœ‰èƒ½å†™çœŸä¸œè¥¿çš„çµæ„Ÿoréœ€æ±‚æ¥ï¼Œåˆä¸¢äº†å½“ç™½è±¡æˆå°±æ„Ÿï¼Œè¿™ç§ä¿¡æ¯å·®çš„æ æ†ä¾¿å´©å¡Œäº†ã€‚æ›´æ— è¯­çš„æ˜¯ï¼Œè¿™æ˜¯é˜³è°‹ã€‚ æˆ‘çš„å·¥ç¨‹å¸ˆæ–‡åŒ–ï¼Œå¹¶éå¥—äººå¥—ç°è‡ªå·±æ¶¦çš„åºæ°æ³¡æ²«å­¦ã€‚ ç†¬å¤œå’Œçƒ§è„‘å°±æ˜¯è´Ÿèµ„äº§å‡æœ¬äº‹ï¼Œç§‘ä¸¾4kyå‘¦æå‡ºå››å¤§å‘æ˜çš„ç¥–å›½äººå¿ƒé‡Œä¸æ¸…æ¥šå—ï¼Ÿ
  - ğŸ˜“ï¼šæ²¡ç¤¼è²Œå’Œä¸é«˜å…´ï¼Œä½ ä¿©åˆ«èŠäº†ï¼Œ æˆ‘ç”¨è¿™ä¿©æ³•åšäº†demoï¼Œéƒ½æœ‰bugï¼  `f=(A)=>A+1; A=0; f(2)==3` åAå±…ç„¶è¢«æ”¹å†™äº†ï¼Œæˆ‘æ¢ğŸ¤“çš„æ–¹æ³•è™½ç„¶OKï¼Œä½†åœ¨ä¸Šæ–‡çš„ `sum(1)(2)` ä¸€ä¾‹ç«Ÿè¾“å‡ºäº†4ï¼Ÿ 1+2==4 ï¼
  - ğŸ˜„ï¼šæ²¡é”™å•Š `sum=A=> B=>env.A+B` è¯¥å¾—4ï¼Œå¦å¤–ï¼Œæˆ‘çš„æ–¹æ³•éœ€è¦æœ‰ `val=(e/*å•å€¼*/,env)=>e.id?env[it] : e.call? val(e,{__proto__:env}) : e.lit? ..` è¿™æ ·çš„å±‚å KVï¼Œä½ æƒ³å•Šï¼Œé‚£æ˜¯è°ƒç”¨ã€Œæ ˆã€å‘¢
  - ğŸ¤“ï¼šæˆ‘å¸Œæœ›ä½ åœ¨è§£æ `load=(s/*å­—é¢æµ*/,fenv)=>e.id&&(e.ç­‰å·å·¦? fenv.æ–°å±€éƒ¨() : fenv.å±€éƒ¨æˆ–_ENV(e.id)) or e.lit ..` æ—¶å°±ç¼–å¥½å·ï¼Œå¯¹é‡åå·¦å€¼è¦æŠ¥é”™ï¼Œåˆ«â€œå˜é‡é®è”½â€ã€‚å¦å¤–ï¼Œå†è¯»é `class sum(A){..}` é‚£å—å§
  - ğŸ˜“ï¼šä½ ğŸ˜„çš„è¯æœ‰ç§ `2^8=xor(2,8)=0b1010` çš„ç¾æ„Ÿã€‚é—­åŒ…æ˜¯ç§æœ‰åŒ–çš„å¯¹è±¡ï¼ŒSAMæ¥å£ï¼ŒIntRefï¼Œç”¨é€”åŸæ¥å¦‚æ­¤ï¼
  - ğŸ˜„ï¼šJavaè®¾è®¡æ¨¡å¼ã€ŒæŠ½è±¡Factoryã€é‡Œå°±æœ‰é—­åŒ…ã€‚ä¸º `grep -oE '^#'` ä»–ä»¬å†™ `InStream().FilterInStream {it[0]=='#'}` ã€‚è®¸å¤šæ—¶å€™classåªæ˜¯{k:funV}ï¼Œè®© `override class D2(xy).Rect(wh)` åƒè¦†å†™funé‚£æ ·è‡ªç„¶ï¼Œå°‘åŠ é‡å¤çš„å‘½åä¼ å‚ï¼Œæ­£æˆä¸ºä¸»æµã€‚
  - ğŸ¤“ï¼šå¯¹äº†ï¼ŒğŸ˜„ä½ åˆä¸æ˜¯nerdä¸“å®¶ï¼Œæ²¡é»‘æ¡†çœ¼é•œï¼Œä¸ºå•¥æŠ¢åœ¨æˆ‘å‰é¢å½“ã€Œè¯­è¨€å¾‹å¸ˆã€
  - ğŸ˜„ï¼šé‚£æˆ‘æ˜¯freakï¼Œçœ‹æˆ‘çš„å¤´é¡¶ã€‚ ä¸ç”¨é«˜çŸ¥çš„å£å»ï¼Œå°±ä¸ä¼šè¯´è¯äº†ï¼Ÿ çŸ¥è¯†å°±æ˜¯çŸ¥è¯†ï¼Œä¸è¦ç”¨åˆ«äººçš„å¯¹é”™ï¼Œæªå¡è‡ªå·±çš„å–èˆå’Œæ±‚çŸ¥ã€‚ #ç å“²
  - ğŸ¤“ï¼šåŸæ¥ï¼Œæˆ‘ä»¬æ™®é€šäººå’ŒLuaçš„ä½œè€…ä¸€æ ·éƒ½æ˜¯ã€Œå¤©æã€ã€‚å­¦è€…ç”Ÿè€Œå¹³ç­‰ï¼Œåªæ˜¯æœ‰è‡ªå·±çš„ä¸ªæ€§é€‰æ‹©ï¼›è¿™æ— å…³å¯¹é”™ï¼Œè€Œæ˜¯æ—§çŸ¥å’Œæ–°çŸ¥ã€‚ **æˆ‘ä»¬ä¸éœ€è¦é åœˆå­çš„ç¬¦å·æ¥åŒ…è£…è‡ªå·±ï¼Œæˆä¸ºä»–ä»¬çš„å¤è¯»å’Œé™„åº¸ã€‚ å¤±å£ä¸ºçŸ¥ï¼Œä¸å¤±å£ï¼Œæ€å§‹å£ï¼Ÿ**
  - ğŸ˜„ï¼šå¾€å¸¸ï¼Œæˆ‘æ˜¯è¯´å¾€å¸¸ï¼ŒçŸ¥è¯†ä¸èƒ½è¢«1:1ä¼ è¾¾ã€‚è¿™ç§å˜å¼‚è‹¥æ˜¯â€œå¤©â€æ‹©ï¼Œä¾¿æˆäº†å…«è‚¡å’Œé„™è§†é“¾ã€‚ è¿™ç§å˜å¼‚è‹¥æ˜¯äººæ‹©ï¼Œä¾¿ä¸æˆåŠŸï¼Œä¹Ÿæˆäººä¹‹ç¾ã€‚ æ²¡ç¤¼è²Œè€…ï¼Œæ­£æ˜¯å¯¹å‰è€…ï¼šæˆ‘è®¤çœŸç†ï¼Œæˆ‘ä¸è®¤çœŸã€‚ æˆ‘ä¸å½“[å¥—å­é‡Œçš„äºº](https://www.thepaper.cn/newsDetail_forward_15633677)ï¼Œä¸è¯´å¥—å­æ¥çš„å­—çš„å¥æŸ„ã€‚å®ƒæ˜¯åŒç®¡é“åº“å¯ã€‚
  - ğŸ¤“ï¼šé•¿è¡«å¯ä»¥è„±ï¼Œè¿™ç†¬å¤œæ”»è¯»å’Œåˆ·é¢˜çš„çƒ™å°ï¼Œå’±ç®€ä¸­äººæ²¡æ³•ç ´èŒ§è€Œå‡ºã€‚æˆ‘é‚£ä¹ˆåˆ»è‹¦ï¼ŒæŒ‰Luaä¸‰ä½œè€…çš„æºç ä¸€è¯è¯æ‘¸ç´¢èµæï¼Œä½ éšä¾¿ä¸€å¥ã€ŒçœŸç†ä¸è®¤çœŸã€å°±æŠŠæˆ‘çš„å¤©æ‰èµ¶ä¸‹ç¥å›ã€‚ æˆ‘å’Œé‚£ä¸‰äººèµ„è´¨ä¸€æ ·ï¼Œæˆ‘å´å†™ä¸å‡ºLuaå—ï¼Ÿæˆ‘å¿ƒç†è¯¥å¦‚ä½•å¹³è¡¡ï¼Ÿ
  - ğŸ˜„ï¼šå¯¹äºæ— å›æŠ¥çš„åŠªåŠ›ï¼Œæˆ‘ä»¬æ€»è¯´ã€Œå¤©æ‰ã€ã€Œè¿æ°”ã€æ¥ç»™è‡ªå·±ä¸Šä»·å€¼ã€‚ä»¿ä½›å­¦é¸Ÿäº†ï¼Œä»åƒç°çš„ä¹¦å †é‡ŒæŒ‘ä¸€æœ¬ï¼Œä¾¿æˆäº†æš´å‘æˆ·ï¼›å´å®åœ¨æ— ä¼‘æ— æ­¢çš„â€œåˆ»è‹¦â€ä¸­æä¸¢äº†è‡ªå·±çš„å¤©æï¼Œèµ¢äº†æ¯”èµ›ï¼Œå½“äº†äººç‰²ã€‚ Dijkstraè¯´ï¼Œä»–ä¸æ‡‚ä¸ºä½•ç®€å•ä¸ç¾çš„ç®—æ³•éƒ½å¦‚æ­¤é«˜æ•ˆï¼Ÿ æˆ–è®¸æˆ‘ä»¬è¯¥ç”¨[ã€Œç»æµã€çš„ç›´è§‰ç®—æ³•](https://t.me/dsuse/19978)æŠ•èµ„å­¦ä¹ ã€åˆ†å·¥ã€æŒ‘é€‰ã€è”åˆï¼Œåœ¨åŠ¡å®ä¸åŠ¡è™šé—´æ‰¾åˆ°å¦è¡ä¸å¹³è¡¡ã€‚ åˆ«å­¦æ™•äº†è‡ªå·±ï¼Œä¹Ÿåˆ«PUAæ§æ€äº†åˆ«äººã€‚
  - ğŸ˜“ï¼šå…¶å®â€¦æœ€æ­£å®—çš„å·¥ç¨‹å¸ˆæ–‡åŒ–æ˜¯ã€Œæœ‰å¤´è„‘ï¼Œæ›´é«˜å…´ã€ã€‚ [Ierusalimschyåœ¨è®ºæ–‡ï¼ˆæ„Ÿè°¢spin6lockç¿»è¯‘ï¼‰ä¸­](https://github.com/spin6lock/the_evolution_of_lua_zh_CN/blob/master/the_evolution_of_lua.md#51-----lua-1) å¯¹Luaåˆåˆ›æ—¶çš„ä¸ªæ€§å’Œè¯•é”™ç›´è¨€ä¸è®³ã€å¯¹è´¡çŒ®äº†åç¨‹å’ŒUpvalçš„ã€Œæ— åä¹‹è¾ˆã€ä¸ä¹èµç¾ï¼Œè¿™ç§å® è¾±ä¸æƒŠçš„å®šåŠ›ï¼Œæ­£æ˜¯æŸäº›é‡è§†å½¢å¼çš„äººæ‰€åŒ®ä¹çš„ã€‚ å•¥æ ·çš„åœŸå£¤å¼€å•¥æ ·çš„èŠ±ï¼Œç§¯ç´¯å¤šé‡çš„æœï¼›å¯¹ä¸çŸ¥reasonåªæ‡‚howçš„é—®é¢˜å°‘ç¢°å¤šç­‰ï¼Œå¤æ‚æ€§è‡ªç„¶å°±å°äº†ã€‚
  - ğŸ¤“ï¼šâ€¦â€¦åˆ†å·¥ï¼Ÿ é‚£éœ€è¦ä¸€ä¸ªä¸ªåˆ†åŒ–çš„åŠ¨æ€ç¯å¢ƒå§ï¼Œä¹Ÿå°±æ˜¯ï¼šå‡½æ•°å¯¼åŒ…ï¼
- 5.2
  - è‡ªç”±å˜é‡æŒ‡å‘ `_ENV`, `_ENV ??= globalThis` (5.1é `const,arg[i],nonlocal[i,j]` çš„å˜é‡åå³å…¨å±€é”®, ç°åœ¨æ”¹æˆ"thisé”®", ä»¥å®ç°æ¨¡å—)
  - 5.1åŸºäºsetfenv()çš„ `module("pip", package.seeall)` è¢«nodeé£æ ¼æ¨¡å— `local pip = {}; function pip:list; return pip`.. `require'pip'` æ¶ˆç­
  - `coroutine:yield()` å¯ä»¥åœ¨try{}å’Œå…ƒæ–¹æ³•(pcall,Proxy)é‡Œè¿”å›ï¼Œæ­¤é­”æ³•æ¯” LuaJIT/CoCo(ç”¨æˆ·æ€çº¿ç¨‹)èªæ˜ã€‚
    - ä¸å…è®¸ç­‰lua_call()è¿”å›ï¼Œå› ä¸ºCè°ƒç”¨æ ˆä¼šä¸¢å¤±yieldåthen()å›çš„ä½ç½®ï¼Œå…¨éƒ¨ç”¨ `L.callk(0,LUA_MULTRET,0, k);return k(L);` Kontå³å›è°ƒã€‚åœ¨Læ ˆä¸Šçš„å‡½æ•°æœªä¼‘çœ æ—¶ç›´æ¥k(L)ï¼Œå¦åˆ™longjmp(throw)ã€‚
    - ğŸ˜„ï¼šyieldæˆ–è®¸å¾ˆéš¾ç†è§£ï¼Œè¯·ä½ å«å®ƒ `sleep(sec=random())` æˆ– `dieWithCallback(f=> looper[0]=f )`
    - ğŸ¤“ï¼šä»¥é˜²ä½ ä¸çŸ¥é“ï¼Œç‹å çš„[ã€40è¡Œä»£ç ã€‘CPS](https://www.yinwang.org/blog-cn/2012/07/04/dan-friedman) å°±æ˜¯è¿™ç§ä¸œè¥¿çš„ç¼–è¯‘æœŸä¼˜åŒ–ç‰ˆã€‚å®ç°while{yield}å¹¶ä¸ç®€å•ï¼Œä½†åœ¨Lispé‡Œä¸€èˆ¬ç”¨ä¼ªé€’å½’tailrec(æ”¹å‚goto0)å’Œunquoteå®(evalä¸²ç•™å­—é¢)åšï¼Œå› æ­¤Lispå¯ä»¥è¯´æ˜¯å…ƒç¼–ç¨‹ç¥–å¸ˆã€‚ åœ¨ã€Œå†…æ ¸æ²¹çŒ´ã€BPFé‡Œï¼Œé€šè¿‡å¼ºåˆ¶whileä¸º `n.times do{}` çš„å½¢å¼æ¶ˆç­æ­¤ç±»åˆ†æï¼Œä¹ŸæŒºèªæ˜ã€‚
    - ğŸ¤“ï¼šLisper è¿˜æœ‰æ›´ç‰›çš„ï¼Œyield åªæ˜¯ call/1cc ï¼Œcallcc å¯ä»¥å®ç°fork()ã€å¯æ¢å¤å¼‚å¸¸ã€å‡½æ•°æ–­ç‚¹ç»­ä¼ åˆ°Nå°æœºä¸Šç®—(workflowåºåˆ—åŒ–)ï¼Œç­‰ç­‰ï¼Œä¸è¿‡é‚£æ ·å°±æ²¡ç”¨å¤„äº†(ä¾èµ–æ³¨å…¥å³éšå¼ä¼ å‚å¯å®ç°å¤§åŠ)ã€‚ Rubyæ›¾ç»çš„ `obj.taint!` èƒ½åˆ†æå€¼æ¶‰åŠçš„å‡½æ•°ï¼ŒshadowJaråˆ™èƒ½çˆ¬æ¸…å‡½æ•°æ¶‰åŠçš„å‡½æ•°ã€‚åªæœ‰Lispçš„è¡¨ç¤ºæ³•ï¼Œæœ€æ–¹ä¾¿æ­ç¤ºå®ƒä»¬çš„åŸç†ã€‚WASMé€‰æ‹©åœ†æ‹¬å·ã€‚
    - ğŸ˜„ï¼šå’Œgotoä¸€æ ·é…·å‘—ï¼Ÿ CPSçš„é­…åŠ›åœ¨äºæ— éœ€ã€Œè°ƒç”¨æ ˆã€ç­‰è¿è¡Œæ—¶ï¼Œä»»ä½•å‡½æ•°éƒ½èƒ½çœ‹æ¸…callerçš„ç»“æ„ã€‚ `f=x=>x0?0:f(x-1)+1; ft=(x,y=0)=>x0?y:ft(x-1,y+1)` çš„åˆ¤åˆ«å°±æ˜“å¦‚åæŒï¼š `f(x-1, R=>r(R+1))` æ˜¾ç„¶ä¸æ˜¯ä¼ªé€’å½’tailrecã€‚ nerdä»¬è§‰å¾—è¿™è¶…é…·ï¼Œå›¾çµæœºå•Šï¼Œä¸å¯åˆ¤å®šå•Šï¼Œè®©P=NPå•¦ï¼Œ[Yç»„åˆå­]()å’ŒSKIå•¦ï¼Œå’Œgotoä¸€æ ·é…·ã€‚
    - ğŸ¤“ï¼šå½¼çŸ¥ä¹è€…ä¹Ÿï¼Ÿ `say(int); say(str); .char(str,idx)int` è¿™æ ·çš„ç±»å‹æŸ¥è¡¨æœ¬è´¨ä¸Šï¼Œåªæ˜¯ç¼–è¯‘æœŸæ®å¸¸é‡ç”Ÿæˆçš„(a is T and..)é»‘ç›’æµ‹è¯•ã€‚æ ¹æ®CHåŒæ„ï¼Œåˆä¸­å®šç†éƒ½ç­‰æ•ˆäºå‡½æ•°çš„ç±»å‹ã€æ³›å‹ï¼Œæ¯”å¦‚ `itself::A->A; not::{A->new('Â¬' A), ('Â¬' A)->A}` ï¼Œè¦è¯æ˜proptestçœŸå‡çš„æ’å®šæ€§ï¼Œåªéœ€æŠŠé‡è½½defå‡ºæ¥ï¼›ä¹Ÿå°±å› ä¸ºï¼Œä½ newçš„æ•°æ®å¿…ç„¶ç¬¦åˆTypeçš„æ ‘ç»“æ„ï¼Œåƒã€ŒçœŸå€¼è¡¨ã€ã€Œä¹ä¹è¡¨ã€é‚£æ ·ä¸¥è°¨å½¢å¼åŒ–ï¼
    - ğŸ˜„ï¼šå™«å˜˜å”ï¼Œå—¯å“¼ï¼ŒDoes it run backwards? [minié–¢é€£](https://tca.github.io/veneer/editor.html) å’Œ [SWI-Prolog](https://t.me/dsuse/18899)-æœ#sql éƒ½æœ‰æ›´ç®€æ´çš„ææ³•ã€‚ç±»å‹çš„æ ¹åœ¨å­—é¢ `1 2 3::int; "1" "2"::[char ln]; f(x)::y,æŸ¥è¡¨æœ‰(f,x,y)` å’Œè§£æ„ç­‰ä½å…³ç³» `get::[A ln], idx->A` ï¼Œå®ƒä»¬ä¹Ÿä¸æ˜¯TEKVè¿™äº›åŠ©è®°ç¬¦ã€‚ propTestå¯ä»¥è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•æ•°æ®ï¼Œé«˜è¿‡fakerjsï¼Œè¿™æ­£æ˜¯å…³ç³»å¼ç¼–ç¨‹(DFSæœç´¢)æ“…é•¿çš„ï¼ŒæŠŠstruct-enumç§°ä¸ºprod-sumTypesä¹˜åŠ ä¸æ˜¯FP/PF/RPï¼Œå®ƒæ˜¯LPé€»è¾‘ç®—æ³•å•Šã€‚
    - ğŸ˜„ï¼šæ ç›®ç­”ã€ç å¯æ‰ã€å‡½ç»­ä½“ï¼Œæœ¬å°±æ˜¯ä¸‰ä½ä¸€ä½“ã€‚FPçš„ `enum{A(int)B(str)}` ADTæ­£æ‹©(äºŒå åˆæ—¶1=x,x=1èµ‹å€¼,unification)ä¹ŸæŒºå®Œå¤‡ï¼Œå¯æƒœä»–ä»¬åªå¿ äºé“¾è¡¨å’Œå›è°ƒé“¾è¡¨çš„ç®€æ´ï¼Œå¿½è§†äº†æ›´ç®€å•çš„ã€Œçº¦å®šä¼˜äºé…ç½®ã€ã€‚ #ç å²
    - ğŸ¤“ï¼šæœ‰ç‚¹é“ç†ã€‚ è½¯å·¥è½¯å·¥ï¼Œæ˜¯æ‡‚æ±‡ç¼–ä¼šèƒŒä¹¦çš„å°‘æ‰ç»„æˆçš„ä½“ç³»ï¼›å¦‚æœç¼–è¯‘å™¨ä¼˜åŒ–å’Œè¯­æ³•ç³–åªæ˜¯ make CPU happyï¼Œå¿½è§†é—®é¢˜é›†å’ŒAPIçš„æœ¬æºé€»è¾‘ï¼Œæˆ‘ä»¬å·²è‡ªç›¸çŸ›ç›¾ã€‚ ç™½é­”æ³•é‡Œæœ‰é»‘é­”æ³•ï¼Œå½“å¿ƒæƒåŠ›é‡Œçš„é˜´å½±ï¼ #ç å“²
  - åƒåœ¾æ”¶é›†å™¨ï¼ˆGCï¼‰å¢åŠ äº†åˆ†ä»£æ¨¡å¼ï¼ŒLuaJITæœªè·Ÿè¿›ï¼Œå› ä¸ºä½¿ç”¨äº†v8çš„ 1bit pointer|float tag ä¼˜åŒ–ï¼
  - ğŸ¤“ï¼šRust::`Option<()>` åŒæ¬¾å‘¦ï¼ x64åœ°å€æ€»çº¿æœ‰40bitï¼Œä¸‡å›½ç å³UTF32æœ‰21bitï¼Œæµªè´¹äº†{24,11}ä½ï¼Œè®¸å¤šè¯­è¨€æ‹¿å®ƒæ¥å­˜typeofç”šè‡³strUmbraé•¿åº¦ã€‚æŒ‰CBORçš„ç¼–æ³•3bitå°±å¤Ÿ `enum JSON{A(int)B(str)}`..äº†
  - GC æ”¯æŒäº†WeakMap(ephemeron table), >40bçš„strä¸å†æ± åŒ– 
- 5.3
  - æ–°LLæ•´æ•°å€¼åŸŸA~B `A=2LL^63LL; B=A-1`ã€‚è¶Šç•Œå›æ»š
  - 'bit32'åº“(ä¸LuaJITçš„64ä½'bit'å‰²å¸­)ï¼Œä¸å†éœ€lightuserdataè£¸æŒ‡é’ˆ
  - GCä¸é»˜è®¤åˆ†ä»£æ¨¡å¼ `collectgarbage("generational")`
- 5.4
  - `local n const = 1, x close = {__close = (x,err)=>}`
  - `1 + "2" ==3`, åŸºäºè¿ç®—ç¬¦é‡è½½ `x=""; for k,v in pairs(getmetatable(x)) do print(k,v) end`
  - é‡‡ç”¨[C99 computed goto](#jmpJIT) `goto opcodeDef[op];`, for(int;) ç­‰æ–°é­”æ³•ï¼Œ2Dæ•°ç»„çš„æ€§èƒ½æå‡è¾¾1å€
  - ğŸ˜“ï¼šå¯¹äº†ï¼Œè°ˆé‚£ä¹ˆå¤šé—­åŒ…å¯¹è±¡ã€å›è°ƒé“¾è¡¨çš„äº‹ï¼Œawait æ€ä¹ˆé  `f=co.wrap{yield sleep()}; z=f(); co.resume(f).then` å®ç°
  - ğŸ¤“ï¼šç»™ä¸ªDuktapeJSçš„å®ä¾‹å‘— 
[â–¶ï¸æ’­æ”¾](https://duktape.org/dukweb#main%20%3D%20async%28function%20%28arg%2C%20aw%29%20%7B%0A%20%20print%28aw%28txt.bind%280%2C%22ä½ %22%29%29%29%3B%20%2F%2Fåˆ«å¿˜äº†bindæ˜¯SAMå¯¹è±¡%0A%7D%29%3B%0Atxt%20%3D%20async%28function%20%28s%2Caw%29%20%7B%0A%20%20aw.ok%20%3D%20s%2B%27æ²¡ç¡å‘¢%27%3B%0A%7D%29%3B%0A%0Afunction%20async%28f%20%2CMe%2CR%29%7B%20return%20function%28%29%20%7B%20var%20a%3D%5B%5D.slice.call%28arguments%29%2C%0A%20%20CONT%3Dco.resume%2C%20ok%3Da.pop%28%29%3B%20%2F%2Få›è°ƒé“¾è¡¨å°¾%0A%20%20function%20HUP%28f%29%7B%20return%20co.yield%28f%29%20%7D%0A%20%20function%20go%28R%29%7Bvar%20r%3DCONT%28Me%2CR%29%3Breturn%20%28void%200!%3D%3Dr%29%3F%20%28r.call%3F%20r%28go%29%20%3A%20r%29%20%3A%20ok%28HUP.ok||HUP.ko%26%26Error%28HUP.ko%29%29%7D%0A%20%20a.push%28HUP%29%3B%20Me%3Dnew%20co%28starmap%28f%29%29%3B%20return%20go%28a%29%0A%7D%7D%0A%20%20co%3DDuktape.Thread%20%2F%2Ff%28*%5B..%5D%29%2C%20å’Œ%20import%20threading%20ä¸€æ ·ä¼ argv%0A%20%20function%20starmap%28f%29%7Breturn%20function%28a%29%7Breturn%20f.apply%28this%2Ca%29%7D%7D%0A%0Amain%28%5B%5D%2Cprint%29)
  - ğŸ˜“ï¼šè¿™é‡Œæœ‰ `main=()=>out= txt("ä½ ").await+txt("æˆ‘ä¹Ÿ").await` ã€‚ä½ ä¹‹å‰è¯´ **åç¨‹=é—­åŒ…+switch(var è¯­å¥å·)** ï¼Œè¿™ä¿©éƒ½æ˜¯åŒè¯­å¥å•Š
  - ğŸ¤“ï¼šè¡¨è¾¾å¼å¤–æå‘— `_0=txt("ä½ "); _1=txt("æˆ‘ä¹Ÿ"); case 2: out=_0+_1` ï¼Œwalkåˆ°awaitæˆ–(?.)æ—¶å¾— `fenv.æ–°å±€éƒ¨` ï¼Œæ”¹çŠ¶æ€å·åŠ å›è°ƒå¹¶returnå˜›

```js
main = async((arg, aw)=>{
  print(aw(txt.bind(0,"ä½ "))); //åˆ«å¿˜äº†bindæ˜¯SAMå¯¹è±¡ï¼Œå¯ä¿å­˜ .gi_frame.f_lasti è¡Œå·
});
txt = async((s,aw)=>{
  aw.ok = s+'æ²¡ç¡å‘¢';
});

async=(f ,Me,R)=>(...a)=>{ let
  CONT=co.resume, ok=a.pop(); //å›è°ƒé“¾è¡¨å°¾
  HUP(f){ co.yield(f) }
  go(R){var r=CONT(Me,R); r.call? r(go) : (void 0!==r)?r : ok(HUP.ok||HUP.ko&&Error(HUP.ko))}
  a.push(HUP); Me=new co(starmap(f)); go(a) //æ³¨æ„ï¼Œå›åº”å¼ç¼–ç¨‹æ²¡æœ‰è¿”å›å€¼
}
  co=Duktape.Thread //starmap=f(*[..]), å’Œ import threading ä¸€æ ·è§£æ„argv

main([],print)
```

- Lua 5.5
  - ğŸ¤“ï¼šè¿˜æ²¡å‡ºå‘¢ï¼ä½ æ˜¯æƒ³è‡ªç«‹é—¨æˆ·ä¸æˆï¼Ÿ
  - ğŸ˜„ï¼šä½ é©¬ä¸Šå°±çŸ¥é“äº†ã€‚ æˆ‘æ˜¯æƒ³é—®é—®æ‰‹å†™äº† `__awaiter` çš„æ™ºåº“å•Šï¼ŒDoes it run backwards?
  - ğŸ¤“ï¼šï¼Ÿï¼
  - ğŸ˜„ï¼š `def:yield` å¾ˆå¥½ç†è§£ï¼Œ`cat|grep|less` çš„è¡Œç¼“å†²åŒºå°±æ˜¯ï¼ŒPyJSæ”¯æŒå¾ˆå¥½ã€‚å®ƒæœ¬èº«åˆå¦‚ä½•ç”¨awaitå®ç°ï¼Ÿ
  - ğŸ¤“ï¼šæœ‰å¥‡æ€å¦™æƒ³å»ºè®®æŸ¥æŸ¥C++æœ¯è¯­å°±æœäº†ã€‚yieldç»™åˆ°.next()çš„calleræ˜¯ä¸Šä¸‹çº§åç¨‹ï¼Œ`await Promise(ok=>ç»™åˆ°å›è°ƒæ³¨å†Œ)` æ˜¯å¯¹ç§°åç¨‹ï¼Œä»€ä¹ˆæ‚ä¸ƒæ‚å…«çš„[è“çº¢é»„â€œå‡½æ•°æŸ“è‰²â€](https://www.whexy.com/posts/func-color)ï¼Œ æ˜¯æœ‰æ ˆåç¨‹/å›è°ƒé“¾è¡¨åç¨‹ç”šè‡³è¯­æ³•ç³–ä¹Ÿï¼Œ ä»€ä¹ˆContext/Dispatcheræ˜¯ä¾èµ–æ³¨å…¥å’Œçº¿ç¨‹æ± é…ç½®ï¼ŒScopeæ˜¯æ¨¡æ‹Ÿfinally{å…±åŒexit}ç”¨çš„ã€‚èƒŒå‹æ˜¯writeä¸éœ€awaitå†™æ¯”è¯»é€Ÿæ…¢å çˆ†ï¼ŒåŒæ ¸æœºå¼€make -j8 å¯¼è‡´åˆ‡æ¥æ¢å»æ›´æ…¢ï¼Œå’Œæ‹¿4Ké¡µswapâ€œä¸‹è½½RAMâ€æ›´æ…¢çš„åŸç†ä¸€æ ·
  - ğŸ˜„ï¼š è¿™æˆ‘æ‡‚ï¼ŒKt inline fun let{} å’Œ `#define let(x,f) f(x)` ä¸€æ ·å¯å¼‚æ­¥ï¼Œæ›´æ”¯æŒå†…è”è·³è½¬(crossinline)ã€‚å°±æ˜¯æ¨¡æ¿ Stream$OfInt{}çš„ä¸€å †ï¼Œå°±æ˜¯è¿™ç§ä¼˜åŒ–
  - ğŸ˜„ï¼š Talk cheap æ”¶æ”¶code
  - ğŸ¤“ï¼š ReactiveX.io è‡ªå·±å»çœ‹ï¼ŒEmitteræµ onNext onDone ï¼ŒComposeçš„Flowç”¨çš„è¿™ç©æ„ï¼Œåªæ¯”React.Stateå°‘ä¿å­˜ä¸ªå½“å‰value å¤šä¸ªonErr
  - ğŸ˜„ï¼šæœ¬ä¹¦ä¸æ•™è¿™äº›ï¼Ÿ å¥½å§ï¼Œä»¥ä¸Šå°±æ˜¯é—­åŒ…ã€åç¨‹ã€æ¨¡å—åŒ–ã€å…ƒç¼–ç¨‹çš„å…¨éƒ¨è§£è¯´äº†ï¼Œå’±è¿˜è°ˆäº†ã€ŒDynamic Scopeã€å’Œä¸€ç‚¹å¾®å°çš„æ„Ÿæ‚Ÿ

æœªè§£ä¹‹è°œï¼š
- è¡¨ä¸‹æ ‡æˆ–è€… userdata çš„é™æ€æ–¹æ³•ä½¿ç”¨(.)ï¼Œ"a".."b" ä½¿ç”¨(..)ï¼Œvarargæ˜¯(...)ï¼Œæ­£å¸¸è°ƒç”¨éœ€è¦ obj:f() !
- it,err=fetch()ï¼Œè¢«æ»¥ç”¨çš„å¤šè¿”å›å€¼ï¼Œæ˜¯æ²¡å­¦è¿‡ `T? or T|Error` Optional&Resultç±»å‹å—ï¼Ÿ
  - å¸ƒå°”&é”™æ§è¿˜æœ‰æ›´ä¸‹å¤´çš„åˆ¤æ³•ï¼Œå’ŒJSçš„ `Array(1e5).map(u=>NEVER)` holeyã€Goçš„åˆ†ç±»å‹nilã€Cçš„\0ç»“å°¾strå¦‚å‡ºä¸€è¾™ï¼š
  - Lua a={1,nil,3} é‡Œçš„â€œç©ºâ€ä¼šå¯¼è‡´ `for i, v in ipairs(a)` æ—©äº`#a`(4) ç»ˆç»“ï¼
  - å¹¸è¿çš„æ˜¯ï¼Œpairs(a) å’Œ `for i = 1, #a do` ä¸è¿™æ ·ï¼Œ `false, ngx.null, cjson.null` ç°åœ¨æ˜¯nilï¼Œè€Œ `a[2]=undef` è§„èŒƒåŒ–äº†nil (<v5.4)
  - `nil,false and print()` **æ˜¯å‡å€¼ä¸ä¼šæ‰§è¡Œï¼Œè¿™æœ‰æ„ä¹‰ï¼Œè®©å®ƒå¹²æ‰°åˆ—è¡¨å¤„ç†+varargï¼Œå¾ˆè ¢ã€‚** è¿™å¹¶ä¸å¥½ç¬‘ã€‚Rustçš„ `()`=Unit=void æ‰ç®—è‡´æ•¬LISPï¼ŒC++çš„ `std::list<T>` ä»¥å¾ˆä¸‘çš„å‘½åcueäº†è¿™ä¸ªã€Œé“¾è¡¨å¤„ç†ä¸­è¯­è¨€ã€ #ç å²
- ä¸‹æ ‡ä» 1 å¼€å§‹ï¼Œå…¶å®å†™å¤šäº†ä¹Ÿèƒ½ä¹ æƒ¯ï¼Œä½†åªè¦ä½ ç´¢å¼•ä¸€ä¸ª ffi.C æ•°ç»„â€¦â€¦
- æå‰è¿”å›ä¹Ÿåªèƒ½å†™ do return endï¼Œå’Œktçš„ `val it=fetch()?.body ?: return "curl fail"` æœ‰äº‘æ³¥ä¹‹åˆ«
- repeatâ€¦untilæ¯”continueè¿˜æœ‰ç”¨ï¼Œå› æ­¤æå‰returnçš„ grep -v '^#' ä¸å¾—ä¸å†™æˆ for in do if then...end end ç”šè‡³ goto next ::next::

## æœ¬ä¹¦çš„è¯­æ³•æ”¹è‰¯

> é’ˆå¯¹è¿‡äºå†—é•¿çš„ `local function do` å’Œå•è°ƒçš„ `if or for` å—ã€æ—¢ä¸JSONä¹Ÿä¸å¤ŸCçš„ `Pair{A,f"A={A}"} / Col2{.B~=1}` å­—é¢ï¼Œåšäº†ç®€åŒ–

```lua
-- è¯æ³•
x = -(y) if kebab-case-å°ä¸å¿åˆ™ä¹±å¤§è°‹å•Š
1\=1  if 'å¯¹ä»—\n'
f"ä»¥få¼€å¤´å‡ä½¿ç”¨{ES6}æ¨¡æ¿å­—ä¸²" == f({"ä»¥få¼€å¤´å‡ä½¿ç”¨","æ¨¡æ¿å­—ä¸²"},ES6)
-kst {YY=true,NN=false,NO=json.null, oo=1/0, pass={nil}} --kvå’Œreté‡Œæ²¡pass,aryé‡Œæ²¡NO, nil=delete

-aZ {"not" "too"}
aZ -1 "fast~"
aZ(1)(1) == "n" -- æ˜¯çš„ï¼Œæ²¡æœ‰ç±»å‹æ¨ç†ï¼Œæ‚¨å¿…é¡»ä»¥ a,aX,a1, nums è¿™æ ·çš„å˜é‡åè°ƒç”¨æ‰èƒ½å¿˜è®°å¥‡å¥‡æ€ªæ€ªçš„ push_back/append/concat
aZ(1,NO) -- å‚2ä¸èƒ½ä»¥aå¼€å¤´ï¼Œä½†å¯ä»¥ a -1 {42,'.',1};a[-1]=[#a-0] å®å±•å¼€
-extend(2,) { table.move(B, 1, #B, A, #A + 1) }

kst -As {
  -YY : not u
  -NN (u,) { true }
  oo: pass
} -- å‡½æ•°å¼èµ‹å€¼ï¼Œåˆ«é—®ä¸ºå•¥ä¸çº¯ï¼Œè¿™æ˜¯å¯¹ç€k:React.useState(v)æŠ„çš„ï¼Œå®ƒæ¯”PFæ›´FP ï¼ˆæœ¬è¯­è¨€ä¸ä¼šå¼•å…¥Signalå“åº”å¼ï¼‰
kst.oo==math.huge
user -As {
  -user.id 2
  -é‡å¼€.age 1 -- åªæœ‰\.(.*) è§†ä¸ºé”®ï¼Œè¿™æ ·æ–¹ä¾¿æ‚¨é‡æ„&æµ‹è¯•
}
-- èµ‹å€¼å’Œåˆ¤å®šå—, passæœ‰ç‚¹ç±»ä¼¼void 0
-n #{1, 2}
-say pass
  if n\=0 { "isEmpty not~" }
  or fallb { fallb }
  or { cry("=falsey like nil, has msg,err=",0x404e) }

-- iforè¿ç®—, ä¸å¯å˜ä¸å¥å£®
-user {-id "Amy" -age 20}
-vs {.id="Amy", .age=20, [ [[k/v/.b4]] ]=3}
pass user
  if u.age>18 {}
  or u.age>10 {}
  or u.age<0 not {} --or{NO}

http":url" or{cry("fail")} { -- or"fail" { é…åˆ f!(x) = pcall(f,x) or{cry("(åŸæŠ¥é”™msg)")}
  body if {u+"ä¸ç©º"} or {f"æ˜¯å‡å€¼={u}"}
  isOK if({"é”™è¯¯","æˆåŠŸ"})
}
pass () {
  inc -i 0
  if (pick -YN) { -i i+1 }
  -i: u+1 -- å®åœ¨ä¸æƒ³å†™ -x if{u} å®ã€‚Luaçš„æµæ°´å¸keywordså’Œå®šä¹‰å¼ç¼–ç¨‹æœ‰ä»‡â€¦â€¦
  -fs DAL("/$fs/tmp") cue
  fs -o 'a.txt' 'good'
} -- cueå˜é‡éšdoåŸŸä¸€èµ·å…³é—­, inc -i å…è®¸é‡èµ‹å€¼

-- fordoå‡½æ•°, classæ¨¡æ‹Ÿ
-A {-1 2 3}
-B pass A for(n,) { pass if n>0{n} } --or{NO}
pass user for { f"{id} ({age})" }
-- æˆ‘ä»¬åŒºåˆ†å•å¥/ç®—å¼ä½ç½®çš„ pass(x)? for|if æ¥å®ç° forEach/mapNotNO, æˆ–æ¨¡æ‹Ÿ py.match: kt.when(val A=){A?->B;}
mapAs {user} (_,){ f"Amy ({_age})" }
-f(x,) {x+1}
pass fsql"SELECT 1, 2" for(2,) { A+B } -- bashå¼å‚æ•°!
-- å…¶å® do=æ ç›®ç­”(æ”¹ENV?), for=mapAs+doå†…è”, if=é»˜è®¤å‚(u)+for, æ²¡é”™ï¼šè¿­ä»£äº¦åˆ¤å®šã€åˆ¤å®šäº¦é”™å¤„ï¼Œä¸åˆ†å¯¹é”™å•å¤š #ç å“²
-- x for|if è‹¥ rawlen(x)==-1 åˆ™ä¸ç´¢å¼•LOOPä¸€æ¬¡, falseyé›¶æ¬¡, v=x if{} å°±æ˜¯ v=v1=NO; if x{v1=..}; v=v1

--è®¡ç®—å™¨Â·æ”¹ï¼
{1 2 3} for(x,){pass x*2 if u>4{u}} -sum (2){A+B} 0 --ç®¡é“|>åªæ˜¯å…¨å±€å‡½æ•°
-sum(A,f,x0) {
  inc -ac x0
  for x in A do ac=f(ac,x) end
  out ac
}

class {
  -Pair(A,B){}
  -Tri(A,B,C){}
  -inc(A,__,B=+oo){} -- è¯·æ³¨æ„ï¼Œ__ä¹‹å‰çš„é»˜è®¤å‚æ•°è¢«(){}è§†ä¸ºtypehintå¿½è§†ã€‚ 2intå¯è¢«å‹ç¼©ä¸º1longï¼Œè¿™ç±»éœ€æ±‚ï¼Œè®©æ™®é€šå‡½æ•°è°ƒ _int(0xAA_BB) å°±æˆ
}
class 'Pair' {
  -swap(_,) {Pair(_B,_A)}
  -B(_,B,A) {Pair(A or _A,B)}
}
Pair{1,2} if {
  -eq21 u -swap
  -eq12 u -B('1')(2) -swap
  --vs u.B('1',2).swap(); æˆ‘ç¡®å®å¯ä»¥åƒ_Aé‚£æ ·ï¼Œä»¤ u.f=u:f, T.f=T.f ä½†ç®—äº†ï¼Œæ¯ç­å§ã€‚çœŸæ­£çš„OOPï¼Œ **å•å‚æ–¹æ³•èµ›é«˜ï¼**
}
-tbl Tri{
  1,2,3,
  'a','b','c',
  {-[]Pair{666,233}}
}
tbl [3]A pairs [1]B==233
tbl [2]C=='c'
-i 3
-tbl.iPrev.C 'è‰' --iNextåŒç†

-o Proxy({}, {get:{x=1}}) --getmetatableå¹¶èµ‹å€¼
o.__proto__.x == 1
pass() {
  -OS chop {
    -Pair.T.swap(_,) {Pair(_A,_B)}
    -- class 'Pair' {åŒåŸç†}
  } cue
  Pair{1,2} -swap --ä¸ç¿»è½¬äº†, AOP refine! åˆ«åœ¨åç¨‹é‡Œç”¨
}
con [[
  lu json:j io math:M coro-spawn
  io ä»…lines
  coro-- fs net
]]
--æ ‡å‡†æ¨¡å— demo.lu
-m {}
-m.greet(name,) {f"Hi {name} from (?) !"}

out m
```

conè¯»ä½œã€Œæ‰›æ¥å¯å¿‘ã€ï¼ŒLuaé‡Œæ²¡æœ‰å­åŒ…çš„æ¦‚å¿µ(`__init__.py`, javax., PIL. Image ImgDraw..)ï¼Œä½†å·¦å€¼ä»ä¸èƒ½ä»¥'.'ç»“å°¾ï¼Œ'io'åŒ…é‡å¤ä¼šæŠ¥é”™

æˆ‘ä»¬å«å¥¹ Runar.lu(ã‚‹ãªè·¯å¨œer)ï¼Œå¥¹æ˜¯Ruby(è·¯å½¼)çš„é—ºå¯†ã€‚è¿™ä¾¿æ˜¯æœ¬ä¹¦é€ç»™ä½ ã€Œæ¯”åŸç†æ›´é‡è¦çš„ä¸œè¥¿ã€ï¼š è¿½æ±‚åŸç†çš„åŠ¨åŠ›ï¼ #ç å“²

ä½ å¯èƒ½æƒ³åæ§½ï¼Œã€Œ`export function greet(){}` ä¹‹æµè™½æ˜¯å‡‘å­—æ•°ï¼Œä½†èƒ½è¢«ä¸»æµå·¥å…·é“¾é™æ€åˆ†æä¼˜åŒ–ï¼Œç¬¨è›‹ï¼ã€ã€‚ å¥½å§ï¼ŒRunar ä¼šæ˜¯ä¸€é—¨ã€Œåœ¨è¿è¡ŒæœŸç¼–è¯‘åˆ°jsã€(runtime codegen) çš„è¯­è¨€

è¿™ç§æŠ€å·§è¢«æˆ‘ç§°ä¸º[ã€Œevalä¸²ç•™å­—é¢ã€](https://github.com/duangsuse-valid-projects/TkGUI)æˆ–[TDDc Test Driven Direct Compile]ã€‚å…¶å®Javaå’ŒC#ç»å¸¸è¿™ä¹ˆå¹²ï¼ bytebuddy.net å°±èƒ½å¤Ÿæ¨¡æ‹Ÿå®‰å“Xposedï¼Œå®ç°Proxyå³delegateå¦‚ `IFile by url{override ..}` çš„å­—èŠ‚ç æ¡†æ¶ã€‚ [lang.invoke](https://lanlan2017.github.io/JavaReadingNotes/b20bb69e/) å’Œå…¶JITå¤§å¤§æ–¹æ–¹åœ°åœ¨è¿è¡Œæ—¶ï¼Œå¤šæ¬¡ç¯¡æ”¹â€œæºç â€

ç¦æ­¢ `for x in"ABC": class(x,{run:()=>x })` æˆ– `class Apis: for x in"ABC": vars()[x]=lambda:x` æ‰æ˜¯é”™å†™æ¼å†™ã€ç±»å‹æ ‡æ³¨ä¸å®Œå…¨çš„æ ¹æºï¼Œæ˜¯æ¶æ„å¸ˆçš„ç“¶é¢ˆï¼Œä¸å¯¹å—ï¼Ÿ


å›é¡¾ä¸Šæ–‡é‚£ä¹ˆå¤šæ¡æ¶ˆæ¯ï¼Œç±»å‹çš„åŠ¨æ€/é™æ€çš„å”¯äºŒåŒºåˆ«ï¼Œå°±æ˜¯ int f()å®šä¹‰/f()å¤ç”¨ä¹ƒè‡³class{}é—´æœ‰æ— å…ˆåé¡ºåºã€‚å¦‚æœæœ‰ï¼Œèƒ½å¦ä»input()ç”Ÿæˆï¼Œè®©å®åˆ©ç”¨æ ‡å‡†åº“å¤§é‡çš„ä¾¿åˆ©å‡½æ•°å‡å°‘å†—ä½™ï¼Œé¿å…ã€Œä¸¤é—¨è¯­è¨€é—®é¢˜ã€ã€‚
printf"%d%s", data class{copy}, Gson, SSMæ¡†æ¶å’Œä¾èµ–æ³¨å…¥çš„AOP/æ¨¡æ¿EL éƒ½éœ€è¦æŸç§åå°„è‡ªæŸ¥ã€‚ åŠ¨é™çš„å¦ä¸€åŒºåˆ«æ˜¯ï¼Œ a=[3]int b=[1]int a+båœ¨comptimeæ˜¯å¦å¯çŸ¥å¯inlineã€‚è¿™ç§GLSLæ•°ç»„å¯¹java int[]æ˜¯æ— ç±³ä¹‹ç‚Šï¼Œå¯¹C int[] æ›´æ˜¯å†…å­˜éƒ½ä¸å®‰å…¨ã€‚

typehintå¾€å¾€éƒ½æ˜¯ä½œä¸ºç¼–è¯‘æœŸtest DSLï¼Œå®ƒä»¬ä¸æ˜¯Objectï¼Œåˆ†æ”¯å¾ˆæœ‰é™ï¼Œenum,list,dict å°±è¶³å¤Ÿæè¿°C,Javaçš„å‡½æ•°/ç»“æ„/æ³›å‹åŒºåˆ† 1+1, 1+"1" äº†ï¼Œè¿™ä¸æ˜¯å®ƒä»¬è¢«æ¡†æ¶è®¾è®¡çš„éœ€æ±‚å°¤å…¶è®¨åŒçš„åŸå› ã€‚
jså¯ä»¥åœ¨xx.f()æ—¶å†å»ç¡®è®¤xxæˆ–å…¨å±€è¡¨å­˜åœ¨fï¼Œè€Œfåªæ˜¯ä¸€ç§ç±»ä¼¼()=> çš„å­—é¢å¸¸é‡ï¼Œxxåªæ˜¯æœ‰åŸå‹é“¾çš„å­—å…¸ï¼›ä½†javaè¦æŒ‰ä¸€ä¸ªç”Ÿç¡¬çš„è¯­æ³•æˆ–ClassFileé™åˆ¶å‡½æ•°çš„ç»„åˆï¼Œå¯¼è‡´ for k in "eat no play": def T.[k]():return k ä¹‹ç±»ç®€å•çš„å†—ä½™ä»£ç (json,http,RPC,argparse..)ï¼Œä»¥è‡³äºT=[str list]ç±»å‹æ ‡æ³¨çš„æ¨ç†å’Œ T.toStr,List.$OfStr ç±»çš„ç”Ÿæˆï¼Œéƒ½æ— æ³•é ç¼–ç¨‹è§£å†³ï¼Œç”šè‡³éš¾äºç†è§£ä½¿ç”¨

å½“ç„¶ï¼Œå®‰å“å’Œgccä¹Ÿç”¨ è®¾è®¡æ¨¡å¼,reflect,Proxy,#define æ¥æ©ç›–ã€ŒæŸäº›å¼ºç±»å‹ç»“æ„æ— æ³•æ¶ˆå†—ä½™ã€çš„é—®é¢˜ï¼Œæ¯”å¦‚Builder vs Pair()apply{A=1;B=2}ï¼Œnullè°ƒç”¨é“¾ vs ?.run{}?:ã€‚ ä¸ºä½•æˆ‘è¯´ def T.[k]() å‘¢ï¼Ÿå› ä¸ºjspyå°±æ”¯æŒ any[k]=any.getattr.k, Cé¢„å¤„ç†ä¹Ÿæœ‰å‡½æ•°å<=>strçš„å®å½¢å¼ã€‚
åªæœ‰ ur.age ç­‰äº ur["age"] (æ‰€è°“çš„åå°„)ï¼Œjsonå’Œå„ç§æ¡†æ¶æ‰èƒ½æ²¡æœ‰é¡¾å¿Œåœ°è¿æ¥å…¶ä»–è¯­è¨€çš„ç›¸åŒç»“æ„ï¼Œè¿™ç§[""]ä¹Ÿå°±æ˜¯æ‰€è°“çš„evalå³unquote{ur.["age"]}è„±ç³–

java ä½¿ç”¨Proxy<æ¥å£> {fform,arg->}ï¼Œ å…¶å®å°±æ˜¯å¯¹ for in: eval: def [k](..): ä¸èƒ½é…åˆç€javacè¿è¡Œçš„å˜é€šè€Œå·²ã€‚ è™½ç„¶ä¸èƒ½ä»json,httpæ¥å£ç”Ÿæˆå¯¹åº”çš„APIç±»ç»“æ„ï¼Œä½†å¯ä»¥åè¿‡æ¥ï¼Œä»fformç¡®è®¤URLå‰ç¼€è¿™ç§ä¸œè¥¿ï¼Œé…åˆæ‰€è°“çš„T.æ³¨è§£:@interfaceå…ƒæ•°æ® - å‡½æ•°å¼çš„jspyé‡Œæ˜¾ç„¶ä¸éœ€è¦è¿™ç§ä¸œè¥¿ã€‚å‡½æ•°ä½“ï¼Œå¯ä»¥ä¾èµ–äºinput()è€Œä¸æ­¢constå…ƒæ•°æ®è‡ªç”±çš„æ–°å»ºï¼Œä¸éœ€è¦C++å’Œrustä»¬æ‰­æ¥æ‰­å»çš„ç¼–è¯‘æœŸè®¡ç®—

è¿™ç§æ€è·¯ç±»ä¼¼åå°„-å°±æ˜¯æŠŠ print(int); print(str) ä¸¤ä¸ªå®šä¹‰åˆå¹¶æˆ print(Any) æ¥è‡ªåŠ¨å¼ºè½¬ï¼Œç”šè‡³è‡ªå®šä¹‰å‡½æ•°åå’Œthisï¼Œè¿™æ ·å¼±åŒ–ç±»å‹ä¾¿èƒ½æå‡ç»„åˆåŠ›ï¼Œé™ä½æ€§èƒ½ï¼Œå…¶æ ‡å¿—æ€§ç‰¹å¾ä¾¿æ˜¯ xx.f çŸ¥é“è‡ªå·±å« "getF"ï¼Œè¿˜çŸ¥é“å‚æ•°ç±»å‹ï¼Œå› æ­¤èƒ½å¯¹åº”åˆ°kv["f"]æˆ– oo["f"].invoke(parse(arg))ï¼Œè¿™å°±æ˜¯ä¸€ç§constexpr
ä¸è¿‡ï¼ŒProxy+åå°„å¼ºè½¬ æ˜¯å¯ä»¥è¢«ä¼˜åŒ–æ‰çš„ï¼Œå‹å‚å’Œå®å‚ç±»å‹ä¸€è‡´å°±è¡Œã€‚ macro.copy(T|T1) ä¹Ÿå¯ä»¥è¢«ç†è§£ä¸º interface Macro{+=fun copy(T):T} ï¼Œæ— è®ºæ˜¯ç”¨reflectæˆ–æ‰‹å†™classå®ç°äº†Macroï¼Œæ•ˆæœä¸€æ ·ã€‚å› æ­¤æˆ‘è®¤ä¸ºjavaå’Œjsçš„å…ƒç¼–ç¨‹åªæ˜¯åˆ‡å…¥ç‚¹æœ‰åˆ«ï¼Œåœ¨ç®€ç¹æˆ–å¹²æ¶‰åŠ›ä¸Šä¸€æ ·å¼ºæ‚ï¼Œä¸éœ€è¦-poetæˆ–ASMé‚£æ ·çš„æ¨¡æ¿codegenã€‚

å…·ä½“åº”ç”¨ï¼Œä¾‹å¦‚ u=Col2(A=0,B=0); trim(u, {k,v-> k[0] as Int})=(41 42) é‡Œtrim(it:T,f:(Str,Any)->Any)æ˜¯åŒºåˆ«äºTçš„traitã€‚ (ITrim as Trait)[T.class].cast(u) å°±èƒ½å¤Ÿã€ŒåŒæ—¶æ˜¯ã€åå°„æˆ–æ‰‹å†™çš„ã€‚è®©Proxyä¼ å…¥ it:T è€ŒéTå€¼ï¼Œä»¥ä»¤ f(it["A"]) = "f(it.A)" è¢«å›´åœ¨ fun(it:T){} é‡Œï¼Œç§°ä¸ºåå°„å¸¸é‡ã€‚


```kt
import java.lang.reflect.*
import kotlin.Array
interface Api {
  fun posts(tag:Int)="?"
  val ver get()="HOOKME"
}

typealias Gen<A> =Method.(A?,Array<Any?>?) -> Any?
fun <T>Proxy(by:Class<T>,u:T?, g:Gen<T>) = Proxy.newProxyInstance(by.classLoader, arrayOf(by)){ _, f, a -> f.g(u,a) }
inline fun<reified T> Eval(noinline g:Gen<T>):T=Proxy(T::class.java,null,g) as T

val u:Api=Eval{A,ar-> ar?.let{""+listOf(*ar,"-${ar.size}$name")} ?: name}

u.posts(2) eq "[2, -1posts]"
//è¯•è¯•ç¼–å†™ infix fun eq å’Œ SAM<Runnable> {1} ä»£ç†ã€‚å½“

(cpp -E|tail -n+7 > a.kts; kotlinc -script a.kts) <<OK
#define any(k) var k:Any?=pass
#define pass Unit

dd="match destruct w/o compiler features"
"ä½ å¥½ æˆ‘å¥½ ä½ åå å®ƒå".split(" ").map {
  val (A,B)=it.split("").drop(1)
  Var(2) { (x,y) -> 
    when(val u=Col2(A,B)) {
      Col2.js("ä½ ",x) -> {dd=x}
      Col2.js(x,"å¥½") -> {dd=x}
      Col2.js(B=y) -> {dd=u.A+"è¢«çœç•¥"}
    }
  }
}
data class Col2<A,B> (val A:A, val B:B) {
  class js(any(A), any(B))
  override fun equals(u: Any?) = if(u is Col2.js) (u.A eq A&&u.B eq B) else (u eq this)
}

any(dd)
  set(v)=println(if(v is Var) v.v else v)
class Var(any(v)) {
  override fun equals(u: Any?)=if(pass==v){v=u; true}else{v==u}
}
fun<R> Var(n:Int, op:(Array<Var>)->R)=op(Array(n){Var()})
infix fun Any? .eq(u:Any?)=if(pass==this)true else this==u
OK
```

ä½†TDDcä¹Ÿå¹¶éå•çº¯ç»™ã€Œevalä¸²ç•™å­—é¢ã€ã€‚ä½ åº”è¯¥å¬è¿‡Python2çš„ä¸€ä¸ªæ¢—ï¼Œ `True,False=False,True` åæ–°defè¿è¡Œæ­£ç¡®ï¼Œè°ƒç”¨æ—§å‡½æ•°å´å´©äº†ï¼Œè¿™è¯´æ˜åªè¦ `override operator fn` è¶³å¤Ÿå¤šï¼Œç¼–ç¨‹è¯­è¨€çš„è¯­æ„å¯ä»¥å¤©ç¿»åœ°è¦†ï¼Œæ˜¯ä½¯è£…æˆã€Œåˆ«äººå®¶çš„è¯­è¨€ã€ï¼Œæ˜¯åµŒå…¥0å°–æ‹¬å·ç‰ˆHTML(vanjs.org)ï¼Œæ˜¯åœ¨GPUä¸Šè®¡ç®—(numpy,taichi-lang.org)ï¼Œæˆ–æ˜¯è¢«â€œSQLæ³¨å…¥â€â€¦â€¦ DSLè€ƒéªŒçš„ä¸æ˜¯ç®—æ³•ï¼Œæ˜¯ä½ çš„éœ€æ±‚å’Œæƒ³è±¡åŠ›ã€‚ ä»Šå¤©å‰åç«¯å’Œå®‰å“çš„â€œé­”æ³•â€ï¼Œè¿œè¿œä¸å¤Ÿï¼Œè€Œç±»å‹ä½“æ“ï¼Œæé”™äº†æ–¹å‘ã€‚

å°±åƒ `await www.baidu.com ({wd="é…·å£³"},'/')` å’Œ `"æŸ¥çœŸèµ„æ–™(void) { https://goog.le;\n goto https; }"` ï¼Œå½“ä½ çœŸæ‡‚è¯­æ³•ï¼ŒçŸ¥é“ `cout<<; printf("%d",1)` ä¹Ÿåªä¸è¿‡æ˜¯åŒè¡Œçš„ä½œå“ï¼Œä½ æ‰èƒ½æ˜ç™½å…ƒç¼–ç¨‹å’ŒPLTçš„reasonã€‚

æ— éœ€parseræˆ–ç®—æ³•/å‡½æ•°å¼ç‰¹æŠ€ï¼Œæ‚¨å¯ä»¥é˜…è¯» [è¿è¡Œå³ç¼–è¯‘ï¼ŒTDDcå°±æ˜¯Visitor]ã€‚é•¿è¯çŸ­è¯´ï¼ŒæŠŠ `x=Pair(1,2); x.B.times(n=> dd=n.å(1))` é‡Œçš„2å˜æˆ [2,'x_B'], æ— è®ºæ˜¯ç”Ÿæˆ `while(x_B-->0) dd=x_B+1` æˆ–æ˜¯å°†å‡½æ•°ä½“å˜æˆã€Œåˆ«äººå®¶çš„è¯­è¨€ã€éƒ½æ˜“å¦‚åæŒï¼Œè¿™æ‰æ˜¯TDDc --ä¹Ÿå« abstract interpretation

## HOLPfulæ¦‚å¿µ

- sikxfanedä¹…ç±»å‹: str idx kv any fn ary nItem eTree decimal
- bcd1248: Cæ•°å€¼ï¼Œbyte char floats
- BYGRP: è§£æå™¨é«˜äº®ï¼Œè“é»„ç»¿çº¢ç²‰ğŸ’™ğŸ¦ğŸ’šğŸ¥“ğŸ’“
- BBop: `operator fn` æŒ‰æ·±å…ˆæµ…åæ’åï¼Œ `litå­—é¢|varå˜é‡å, As() Sa.[]^, Not, Xãƒ(kana:no) RemLt%, åä¸€, Lt< Gt> XLt>= XGt<= , Eq== Ew~=, And, Or`
  - Luaè¿˜æœ‰ neg- n# vararg.. å’Œä½è¿ç®—&| shl<< shr>> ï¼›è¿™äº›æœ¯è¯­åœ¨ `Proxy(x,{Sa=__index})` é‡Œè‡ªåŠ¨ç¿»è¯‘ï¼Œä¹¦å°¾ç”¨å®ƒä»¬åš2Då‡ ä½•æ¸¸æˆã€‚

bcd=|1|2|4|8
-|-|-|-|-
Byte|`0xb1`|short|âœ“int|long|âœ“ssize_t
Char|âœ“uint8|u16|u32|u64|uintptr|u128|'\U.{8}'
Decs|||d4|âœ“double

æœ¬ä¹¦å˜é‡å‘½åå‡ä½¿ç”¨ä¹…ç±»å‹ï¼ŒCæ•°å€¼ç»“æ„ä½“å‡ä½¿ç”¨0xbcdã€‚ #ç å“²

## æºç æ ‘å¯¹åº”äºå‘½åå‰ç¼€

```
luaA_ - lapi.c  - Lua API. Implements the bulk of the Lua C API (lua_* functions).
lua_  - lapi.c/h + luaconf.h
luai_ - luaconf.h
luaopen_ - luaconf.h + libraries
  luaB_ - lbaselib.c - stdlib
  ldblib.c, debug.c
  liolib.c, loadlib.c, loslib.c
  lstrlib.c, ltablib.c, lmathlib.c

luaC_ - lgc.c - incremental garbage collector (memory management)
luaD_ - ldo.c - stack and Call structure of Lua. Handles function calling (luaD_call / luaD_pcall), growing the stack, coroutine handling, ...
luaE_ - lstate.c - global state. Includes functions for opening and closing Lua states (lua_newstate/lua_close) and threads (luaE_newthread / luaE_freethread).
luaF_ - lfunc.c - auxiliary functions to manipulate prototypes and closures
luaG_ - ldebug.c - debug interface. 
luaH_ - ltable.c - Lua tables (hash)
luaI_ - lauxlib.c - defines the luaL_* functions
luaK_ - lcode.c - code generator for Lua. Used by lparser.c
luaL_ - lauxlib.c/h, linit.c (public functions)
luaM_ - lmem.c - interface to the memory manager. This implements luaM_realloc / luaM_growaux_, which wrap the memory allocation functions.
luaO_ - lobject.c - some generic functions over Lua objects. Includes datatype <-> string conversions, raw equality test (luaO_rawequalObj), and log base 2 (luaO_log2)
luaP_ - lopcodes.c - opcodes for Lua virtual machine. Defines names and information on all opcodes (via tables luaP_opnames and luaP_opmodes).
luaS_ - lstring.c - string table (keeps all strings handled by Lua)
luaT_ - ltm.c - tag methods. Implements accessing metamethods from objects.
luaU_ - lundump.c - load precompiled Lua chunks. 
luaV_ - lvm.c - Lua virtual machine. Executes bytecodes (luaV_execute). 
luaX_ - llex.c - lexical analyzer. Used by lparser.c.
luaY_ - lparser.c - Lua parser.
luaZ_ - lzio.c - a generic buffered input stream interface.
```

# ç¼–ç¨‹è¯­è¨€ï¼šä»è®¡ç®—å™¨å¼€å§‹

## éš¾åº¦æµ‹è¯•ï¼šæ­¥éª¤è®¡ç®—å™¨ã€é…æ‹¬å·æ”¹å­—é¢ã€çŒ´è¯­è¨€VM

```py
# åŒ¹é…å·¦å³æ‹¬å· paren
_c01 = {'(':')', '[':']', '{':'}'}
def eat(s,c1):
  for c in s:
      # å¦‚æœæ˜¯å·¦æ‹¬å·ï¼Œå°±æŠŠå®ƒå‹å…¥æ ˆä¸­
      if (c1:=_c01[c]): ifErr='è¡Œå·'; eat(s,c1)
      elif c==c1:return # å¦‚æœæ˜¯å³æ‹¬å·ï¼Œå·¦æ‹¬å·ä¾¿ä¸ä¹‹åŒ¹é…
      else: assert'','å¤šä½™é¡¹è€Œæ ˆç©º' #ä»…æ”¯æŒçº¯æ‹¬å·æ–‡æœ¬, å¦åˆ™è¦_c10,åå‘
  assert c0=='eof','æ ˆå°šä¸ä¸ºç©º'
```

## ä»stringifyå’Œparseå­¦æ‹©æ·±

æ— è®ºæˆ‘ä»¬æ„é€ å“ªç§ç¨‹åºï¼Œéƒ½å¿…é¡»å…ˆç©·ä¸¾å®ƒæ‰€å¤„ç†æ•°æ®çš„ç»“æ„å’Œè¾¹ç•Œæƒ…å†µï¼Œä»£ç æ˜¯æµåŠ¨çš„æ•°æ®ï¼Œå†…å­˜æ˜¯å‡å›ºçš„å‡½æ•°ã€‚

å› æ­¤ï¼Œæƒ³loadæŸç§æ ¼å¼ï¼Œä½ å¾—å…ˆdumpå®ƒï¼Œä»æµ…æ˜¾éå†ç¨‹åºçš„ç»“æ„è·å–ç›´è§‰ï¼

JSONé€’å½’ä¸‹é™è§£æå™¨ï¼Œå’Œè¯­æ³•å°±æ˜¯ä¸€ä¸€å¯¹åº”ï¼š

```ini
JSON  X
X  (S|D|{S:X ,}|[X ,]|true|false|null)
S '"' ([^\\"]+|\\Esc)* '"' #G-
Esc ["\/nrtfb]|u hex{4} #Gk

D num (.int)? ([eE]int)? #Bn
num '-'? ([1-9]int|[0-9])#Bn

hex [0-9a-fA-F]
int \d+
ws ' \n\r\t'*
# ws:æ¯å°å†™ç¬¦å·å‰è¦è·³ç©ºæ ¼ï¼Œ #é«˜äº®tag å†…ç¦ç”¨
```

(int ,) è¡¨ç¤º int (, int)* ï¼›å…¶ä»–å‡æ˜¯[æ­£åˆ™ç¬¦å·](https://regex101.com/library/tA9pM8)ï¼Œè¿™äº›æ¨¡å¼éƒ½æ˜¯90% C-like è¯­è¨€é‡Œå…±äº«çš„ï¼Œä½ æ‡‚çš„

æ‚¨å¯èƒ½å¥½å¥‡
- ä¸ºå•¥Så€¼ä¸èƒ½å’ŒTOML.ioé‚£æ ·å…å¼•å·ï¼Ÿ
  - trueå’Œemojiç­‰â€œéå˜é‡åâ€çš„åˆ¤å®šå¯æ˜¯ä¸ªå¤§é—®é¢˜ã€‚
- `{"è¿™é‡Œä¹Ÿä¸è¡Œ": }` ï¼Ÿ
  - JSONå‘å¸ƒæ—¶JSè¯­æ³•è¿˜æ²¡åŠ  `{"Brendan Eich": 0, "":1}` ä¹ƒè‡³ `{[1+1]: 2}`
- Då€¼ä¸ºå•¥é™åˆ¶_1to9èµ·å§‹ï¼Ÿ
  - chmod 0644 æ˜¯å•¥ï¼Ÿè¯•è¯• `[...0644.toString(2)].map((u,i)=>u==0?'-': 'rwx'[i%3])` ï¼Œè¿™æ˜¯8è¿›åˆ¶(2^3)çš„å”¯ä¸€ç”¨é€”ï¼Œå®ƒä¸å¦‚2ä½16è¿›(16^2=2^8)
- JSON.orgä¸ºå•¥ç”¨ `ws ""|'\u0020' ws` è¿™æ ·å¥‡æ€ªçš„ BNF schema
  - å·¦é€’å½’è¡¨é‡å¤+é¡ºåºåŒ¹é…ã€‚ [PeggyJS.org](https://ohmjs.org/editor/) ç”¨å®ƒåšWebè®¡ç®—å™¨ (é“¾æ¥æ²¡åï¼Œç‚¹ç‚¹çœ‹ã€‚è«æ±‚ç”šè§£è®°å¾—å›æ¥ï¼)
  - Luaç”¨é€†æ³¢å…°è¯»è¿ç®—é“¾ï¼Œæ›´å¿«
- 1e2 æ˜¯100ï¼Œå’‹ç®—ï¼Ÿ 
  - `1*Math.pow(10,2)` or 1*10**2 or.. `A=+("1"+'0'.repeat(2))`
  - å¯ä¼˜åŒ–A=StringBuilder().push('')ï¼š `[...'123'].reduce((A,u)=>A*10+ +u)`, `unfold(123, (A,u)=>(u(A%10), A/10 >>0))`
  - libcå’Œbase64æ˜¯è¿™ä¹ˆåšçš„ã€‚å—¯å“¼ï¼Œä½è¿ç®—ã€‚å†™ä¸‹unfoldå§
- JSå­—é¢æ¯”JSONå¤šäº†å•¥ï¼Ÿ
  - 0xCAFE_BABE, +inf,NaN,1e-2, æ³¨é‡Šå’Œå°¾é€—å·
- æˆ‘æƒ³æ‰¾æ›´æ˜“å­¦ã€ç©ºé—´æ•ˆç‡æ›´é«˜çš„JSON
  - BitTorrent/BEncodingï¼š `X=i(N)e|N:Hex|[ld](X*)e|[tfo], N=[0-9]+` ï¼Œè¿™å°±æ˜¯å…¨éƒ¨ï¼š `l3:abci123ee` ã€‚3:abc è§„é¿äº†å¤§å°ç«¯ã€\0|"ç»“å°¾çš„ `Escape(%20,&lt;)` é—®é¢˜ï¼
  - CBOR.me: `byte0=0bT{3}N{5}; T0~7=N-hsaked`, N:+ç«‹å³æ•°, hex:å°¾éšNbytes ï¼ŒåŸºäºå¤§ç«¯bitfieldå‹ç¼©è€Œå·²ï¼Œä¸å±•å¼€è®²
- rapidjson, SIMDjson å¿«åœ¨å“ªé‡Œï¼Ÿ
  - å‘é‡åŒ–ï¼Œ1æŒ‡ä»¤è·³Nç©ºæ ¼ã€‚ åè€…ä¼šé¢„ç­› `\"` ç­‰è¾¹ç•Œä½ç½®ï¼Œå¼ºåˆ¶SAXçš„pullæ¨¡å¼ï¼šå•æ¬¡éå†å…GC
  - Visitoræ¨¡å¼ä¹Ÿå¯ä»¥pullï¼Œå«å•¥ä¹‹algebraï¼Œè¿™ç±»[æœ¯è¯­è¡¨æ ¼]æ–‡å°¾æˆ‘ä¼šè´´å‡ºï¼Œæ–‡å†…æˆ‘ä¸å®¹å¿è¿™ç±»å«ç³Šå…¶è¾çš„å‘½åã€‚
- ğŸ˜‰å’±ä¸è®²Luaäº†ï¼Œè¿™ç®—è·‘é¢˜å—ï¼Ÿ 
  - å…ˆå­¦ä¼šè·‘ï¼Œä½ æ‰èƒ½é£å¾—æ›´practicalã€‚ è¯»ä¹¦ä¸æ˜¯å½“Luacé‚£ç§one-passç¼–è¯‘å™¨ï¼Œ**å’ŒåŸåˆ›è€…ã€Œå…±åŒé¢å¯¹é—®é¢˜ã€ä½ æ‰èƒ½æ¶ˆé™¤ä»£æ²Ÿï¼Œè€Œä¸æ˜¯å¤è¯»ä»–é™„åº¸ä»–ã€‚** #ç å“²
  - ä»PLT&DSLå®è·µè®²ï¼Œæ ‘ç»“æ„çš„åˆ†æå¤„ç†ï¼Œè§¦ç±»æ—é€šï¼Œä¸”æœ‰ç®€ç¹å…ˆåã€‚ åˆ«å†…å·ï¼Œå‹¤å­¦ï¼Œæå¥½é—®ï¼

## ASTé€’å½’å…¼VMæµæ°´çº¿çš„æ ¹åŸºï¼šç»“æ„ä½“å…±å­˜ä½“

```js
data Val=L Int|Op Char Val Val deriving(Show)
(Op '+' (L 1) (Op '*' (L 2) (L 3) ))
```

# ç¼–ç¨‹éç®—æœ¯

```js
1+2*3
å(1, X(2,3)) -7

å=(A,B)=>A+B
ã€Œå‰ç¼€å¼polish notationã€ï¼Œæ˜¯Lispçš„å›½æ˜¯
æ•™ä¸ªå°è¯€çªï¼šjsé‡Œå‡½æ•°åªæ˜¯ä¸€ç§å­—é¢å¸¸é‡ï¼Œå¯ä»¥è¢«forç”Ÿæˆ
Object.entries("åä¸€Xãƒ").forEach(([i,x])=>
  this[x]=eval(`(A,B)=>A${"+-*/"[i]}B`))
```

å†çœ‹ä¸‹ã€Œè§£é‡Šå™¨interpreterã€æ¯”è®¡ç®—å™¨å¼ºåœ¨å“ªï¼š èƒ½å¤Ÿâ€œåœ¨è°ƒç”¨æ—¶ä¼ å€¼â€ï¼Œä¹Ÿå°±æ˜¯è¦æœ‰ argument[0] è¿™ç§â€œç¯å¢ƒå˜é‡â€
å¾ˆå‰å®³ï¼ç°åœ¨æœ‰å¸¸æ•°å¤–çš„â€œè¯­æ³•â€äº†ï¼Œæœ‰å˜é‡äº†ï¼Œé«˜é˜¶äº†ï¼æˆ–è®¸ä½ éœ€è¦å­¦åŠ¨æ€ä½œç”¨åŸŸ(åŸå‹é“¾?)ã€è°ƒç”¨æ ˆcall-retã€æƒ°æ€§æ±‚å€¼å¦‚&&|| blablaï¼Œè¿˜æœ‰æ·±ä¸å¯æµ‹çš„ç¼–è¯‘ä¼˜åŒ–å‘¢ï¼
ä¸å°±åŠ ä¸€ä¸ªç®­å¤´ä¹ˆã€‚

```js
å=(A,B)=> (env=>A(env)+B(env)) //å,ä¸€,X,ãƒ.. ç°åœ¨çŸ¥é“ä¸ºå•¥è¯¥ç”¨forå®è€Œä¸æ˜¯é”®ç›˜ç”Ÿæˆå‡½æ•°ï¼Ÿ
Lit=x=> env=>x
Arg=i=> env=>env[i] //PHPå†™ä½œ $x, æ¨¡ä»¿bashçš„$1~$*
Fun=(n,f)=>f(Array(n).fill(0).map((x,i)=> Arg(i)))
```

envè¢«ç§°ä¸ºè¿è¡Œæ—¶ï¼Œå®ƒå¯ä»¥æ˜¯JVM, import dis PVMæˆ–è€…åˆ«çš„bytecodeè§£é‡Šå™¨ï¼Œè¿™èƒ½å‡å°‘tree.walkå¯¹é€’å½’æ ˆçš„é¢‘ç¹ä¾èµ–
è¿™ç§ `formSytanx.bind(consts=lit/arg/global/Types..)` çš„"éƒ¨åˆ†ä¼ å‚"å‡½æ•°ï¼Œç§°ä¸ºç¼–è¯‘å™¨ï¼Œè€Œå®ƒçš„è¿”å›å°±æ˜¯classFileç­‰ç±»å‹ã€‚ 

ç¼–è¯‘å™¨å¹¶ä¸éœ€è¦ä¸DSLè¿™äº›æŠ€å·§éš”ç¦»ï¼šå¦‚æœæˆ‘ä»¬æŠŠ env=>x å†™ä½œ JSON(x) è€Œ env=>env[i] å†™ä½œ$i ï¼Œæ—¢ `Lit=x=> gcc? CBOR.dumps(x) : (env=>x)`
ä»¥è¿™ç§äººç±»æˆ–æœºå™¨å¯è¯»çš„ç»“æ„ï¼Œåºåˆ—åŒ–ä¸€äº›å‡½æ•°è¢«"bind"åˆ°çš„litï¼Œå°±å¾—åˆ°äº†å¯¹åº”çš„ä»£ç ã€‚jvmçš„ `lconst 1, aload_0 thiså‚æ•°, iadd (AB->C)` ç”šè‡³æ˜¯(Dexer/AOT)è‡ªåŠ¨åˆ†é…å‚æ•°å¯„å­˜å™¨çš„ï¼

å¦‚æœä½ ä¹æ„ï¼Œè¿˜å¯ä»¥æ”¯æŒåŸºäºå…¨å±€è¡¨çš„é€’å½’ `fib=f(x)=x<2? 1 : f(x-1)+f(x-2) `
è¿™ä¸€åˆ‡ï¼Œéƒ½ä¸ä¼šçªç ´ä»¥ä¸Šçš„å®šä¹‰æ¡†æ¶ã€‚ If ä¸ä¼šï¼ŒCall(f,x-1) ä¸ä¼š.. è¿™å°±æ˜¯javaçš„åå°„å˜›ã€‚

æˆ‘çœ‹è¿‡è®¸å¤šâ€œç¼–è¯‘åŸç†ä¹¦â€ï¼Œä»–ä»¬è¿è¿™ä¸ª=>éƒ½å†™ä¸æ˜ç™½ã€‚ æ›´ä½•è°ˆ[ç”¨Visitorå®ç°(æ­£å)åºåˆ—åŒ–](https://t.me/dsuse/19808)â€¦â€¦

## å¤šå‹æ€ï¼šå­ç±»å‹ã€æ³›å‹çš„inout

## æ‰å¹³è¯»å†™ASTï¼šé€†æ³¢å…°å­—èŠ‚ç 

## å·ç‹ï¼Œè·‘ä¸‹åˆ†

## ä¸€éè¿‡vsç¼–è¯‘å¹¶rustfmt

[Visitoræ ‘è§£æ„ OR å‡½æ•°å­—å…¸pulläº‹ä»¶-é›¶æ‹·è´](https://zhuanlan.zhihu.com/p/163762783)

[çº¯é¢„å¤„ç†å®ML99](https://github.com/hirrolot/datatype99?tab=readme-ov-file#usage)

```kt
/*
datatype(Calc,
  (A, int),
  (Op, Calc*, int(op)(int,int), Calc*)
); //çº¯é¢„å¤„ç†å®ML99 ADTå†™æ³•
*/
interface Goes<out T> { fun go(): T }

sealed class Calc: Goes<Int> {
  /* A literal */
  data class A(val n: Int): Calc() { override fun go() = n }
  data class Op(val a: Calc, val b: Calc, val op: Int.(Int) -> Int): Calc() {
    override fun toString() = "($a ? $b)"
    override fun go() = op(a.go(), b.go())
  }
  companion object DSL {
    operator fun Int.not()=A(this)
    infix fun Pair<Calc,Calc>.go(f:((Int,Int)->Int))=Op(first,second,f)
  }
}
val c = Calc.run { !1 to !2 go Int::plus }
c.go() //3
```

```kt
interface Goes<out T> { fun go(): T }

interface TrimCalc<out R> {
  fun Tr(e: Calc.A): R
  fun Tr(e: Calc.Op): R
  //ä¸Šé¢æ˜¯é—­åŒ…ç‰ˆï¼Œé›¶æ‹·è´ç‰ˆæ˜¯ fun Op(a: Calc, b: Calc, op: Int.(Int) -> Int): R
}
operator fun <R>Calc.invoke(u: TrimCalc<R>): R = when (this) {
  is Calc.A -> u.Tr(this)
  is Calc.Op -> u.Tr(this)
  //å¦‚æœ Calc ä¸ sealed, è¿™é‡Œå¾—åŠ  else -> throw Error("impossible") as Nothing
  //ä¸€èˆ¬è€Œè¨€ï¼Œå› ä¸ºOOPé»˜è®¤å¯¹ arg0 dispatch(å­ç±»å‹override+overloads)ï¼Œä¸ä¼šæ‰‹å†™è¿™å¤–æŒ‚Visitorè€Œæ˜¯è¿ sealed enum ä¸€èµ·ç”Ÿæˆ
}

```

## æ´»å­¦æ´»ç”¨ï¼šsexpè„‘å›¾ã€é«˜çº§æœç´¢è¯­æ³•ã€çœŸÂ·æ­¥éª¤è®¡ç®—å™¨

```js
//Top  Str|[0-9]+| '(' Top* ')'
tok=(cod, s=cod.split(/\s+|([()]|\w+|\S+?)/).filter(x=>!!x).values())=>
 ()=>s.next().value

sexp=s=>{let a=[],x;for(;(x=s())&&x!=')';)a.push(x=='('?sexp(s):x); return a}
//^ ä¸€èˆ¬éœ€é…å¯¹')'ã€‚æ­¤çœè¡Œæ•°ï¼ŒF12 sexp(tok(prompt()))
sexp=(s, a=[], f=()=>{let x,i=0;for(;(x=s())&&x!=')';i++) {x=='('?f():a.push(x)} a.push(i) })=>(f(),a)
//'(a (b c) d)' æ¢RPN [a b c 2 d 3], æ‰å¯å•æ­¥ï¼Œæ˜¾ç¤ºæ­¥éª¤

strm=([s], i=0)=>(n,took)=>{ let k=s.slice(i,i+n); i+=n; return (took===NO)? k : (took)? took(k) :  (i-=n, k) }
NO=null, ps={parser:'json'}
ps.D=(s, it=0,shr=0)=>{ //D num (.int)?
  while(+s(1)) it=it*10+(+s(1,NO))
  if(s(1)=='.') { s(1,NO) // è¿™äº›é€»è¾‘å¯ä»¥é Combinatorå¤ç”¨
    for(;+s(1); shr++) it=it*10+(+s(1,NO))
  }
  return it*Math.pow(10,-shr)
}

optab={[';']:-1}
"=;+ -;* /".split(';').map((a,L)=>a.split(' ').forEach(x=> optab[x]=L ))
exp=(L/*evels å¤§åˆ™æ·±,ç´§ */, s/*å­—é¢æµ: xå•é¡¹ oç®—ç¬¦ xo..*/, ord=[])=>{
  let o,x=()=>add(Number(s())), add=(x)=>ord.push(x),
  at=O=>{let A,B; x()
    for(o=s();(A=L[o])>=(B=L[O]);)if(A!=B)at(o); else{add(O);x(); O=o;o=s()} add(O)
  }
  ord.Sum=(f,a=[])=>ord.forEach(x=>a.push(x.substr? f(x,a.pop(),a.pop()) : x))
  at(";");return ord //é€†æ³¢å…°ç®—ç¬¦é‡æ’
}
(e=exp(optab,tok(prompt())) ).join(' ')
//å¦‚ 1*2*3+4 '1 2 * 3 * 4 + ;' ä»¤12*=[*1 2]ï¼Œé‡åˆ°ç›¸åŒæ·±åº¦è¿½åŠ ï¼Œå¦åˆ™å†…åµŒå¯ã€‚
e.Sum((f,A,B)=>f==';'? A : eval(A+f+B)) 

//å°ä½œä¸š: æ‰§è¡Œ A=NN, Aä¸”Bæˆ–C; A=YY,B=YY, Aä¸”(B æˆ– Cæ˜¯1) ã€‚ é‡'('é€’å½’expå³å¯ï¼Œord[]è‡ªåŠ¨è¢«ä¿å­˜æ¢å¤çš„

//import re å®˜æ–¹ç¤ºä¾‹
RElex=kv=>{
  let re=Object.keys(kv).map(x=>`(${x})`).join('|'), mf=Object.values(kv),m,i,j=0
  re=RegExp(re, 'gy')
  return (s,ontok)=>{
    for(m of re[Symbol.matchAll](s)) ontok(
      mf[(j=m.findIndex((x,i)=>null!=x &&i!=0))-1](m[j]),  (i=m.index), i+m[0].length
    )
}}

_2sREP=RElex({
  '\\d+':parseInt,
  '[a-zA-Z]+':s=>s,
  '\\s+'(){}
})

```

## æ’æ·±ï¼Œæ¯”èŠ±æ‹¬å·æ›´æ·±

# è§£é‡Šå™¨=è®¡ç®—å™¨+strå’ŒvarNameBind

è§£é‡Šå™¨å’Œç¬¬ä¸€ç« çš„è®¡ç®—å™¨ï¼Œå…¶å®åªéš”3ç‚¹ï¼šå‰ç¼€æ ‘ã€åç¼€æ ‘ã€å†…å­˜åŸŸã€‚ ä»Lispåˆ°JavaCï¼Œä½ ä¼šå‘ç°å„ç•Œè¯­è¨€éƒ½ç¦»ä¸å¼€è¿™ä¸‰ç§ç»“æ„ã€‚

[Lexical Scopes](https://bobi.ink/2019/10/01/babel/#:~:text=æ ¹æ®æºä»£ç çš„è¯æ³•ç»“æ„æ¥ç¡®å®šä½œç”¨åŸŸ)

## å‚æ•°slotåŒ–ã€æµæ§ä¸å›å¡«slotï¼Œæ¨¡å¼åŒ¹é…

## è°ƒç”¨æ ˆï¼šå¼‚å¸¸å’Œåç¨‹çš„é­”æ³•

[js2lua çš„try-catchå®ç°](https://github.com/PaulBernier/castl/blob/master/doc/try%20catch%20implementation.lua)

## å…ƒç¼–ç¨‹

# GC=ä¾èµ–å›¾=æ ‘+ç¡¬é“¾æ¥å‡æ

## é›•è™«å°æŠ€ï¼šåŒºé—´é«˜äº®ã€äºŒè¿›åˆ¶é—´ç»‘å®š

```js
rep=(txt,on, n=null)=>f(txt,x=> (x==null)?on(' '):
  (x.substr)? (on(x.repeat(n)),n=null) : 
  (n=x)
)

buildAry=(f,a=[])=>(f(x=>a.push(x)), a)

rnSel=(e,A,B,o=new Range)=>(o.setStart(e,A),o.setEnd(e,B), o)
rnHL=(e)=>
e.oninput=()=>{CSS.highlights.clear(); f(e.textContent, (x,A,B)=>{
  let on=tag=>CSS.highlights.set(tag, new Highlight(rnSel(e.firstChild,A,B)))
  ;(x==null)?0:
  (x.substr)? on('str') : 
  on('num')
})
  hout.textContent=buildAry(rep.bind(0, e.textContent)).join('')              
}


document.write(`
<style>::highlight(num) {
  background-color: #f06;
  color: white;
}
::highlight(str) {color:red}
</style>
<div contentEditable id=hl></div>
<mark id=hout>
`)
rnHL(hl)
```

[å®½åŒ–å¤§æ•°]
[pcmè§£ç ](https://zhuanlan.zhihu.com/p/8955711051)

## Rc::shared_ptrã€åŒæŒ‡é’ˆå¯¹è±¡ã€Hashé¢„åˆ†ç»„æŸ¥è¡¨

## â€œè›‹ç”Ÿé¸¡æ–‡åŒ–â€ï¼šè‡ªä¸¾quine 

ä»€ä¹ˆè¯­è¨€æœ€å¥½ï¼Ÿè¿™æ˜¯ä¸€é“ä¸»è§‚é¢˜ã€‚ é‚£ä»€ä¹ˆè¯­è¨€æˆ–æ¡†æ¶æœ€å¿«ï¼Ÿçœ‹ä¼¼æˆ‘ä»¬èƒ½å¤Ÿå®¢è§‚å¾—å‡ºRustæœ€å¿«ï¼ŒCBORæ¯”JSONå¿«äº†ã€‚ä½†æ¶‰åŠçš„ç¯å¢ƒå˜æ•°å¤ªå¤šï¼Œå¾ˆå®¹æ˜“è¢«ã€Œå›¾ç‰‡è¯¯ç”¨ã€äººä¸ºæ“ä½œã€‚è¦æ§åˆ¶å˜é‡ã€‚

æ˜¾ç„¶æœ‰ç§ç¨‹åºæœ€æ˜“æµ‹è¯•ç¼–è¯‘å™¨æ˜¯å¦å®Œå¤‡ï¼š å®ƒè‡ªå·±ï¼ è¿™ä¾¿æ˜¯bootstrapç¼–è¯‘ï¼Œrustå’Œgccç”¨å®ƒæ¥è‡ªæˆ‘æµ‹è¯•ã€‚

[Quine ç¼–è¯‘æ¥é¾™](https://www.fxzhihu.com/question/30262900/answer/47877068)

[esolangs å›¾çµå®Œå…¨æç®€è¯­è¨€(å¯ç”¨äºä½é€Ÿæ¨¡æ‹Ÿä»»æ„è™šæ‹Ÿæœº)](https://www.zhihu.com/question/5968069862/answer/48623206225)

## æœ¯è¯­è¡¨æ ¼