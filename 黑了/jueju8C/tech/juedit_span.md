
在你学习 Eclipse 和 Notepad++/2 的时代，编辑功能基本上只有按模板新建和代码高亮，绝谛当然也支持按主题高亮已知语言文本、配对括号和同名变量。这些不靠扫描光标附近符号实现，其实，绝谛有同款于juec编译器或IDEA的方式操作正被编辑的代码：语法树 另+区间表。

- VSCode 的编辑框引擎 Monaco 会把代码分词，渲染成网页片，当增删时增量分词，只更新排版后有变的片。
- 当你在 DevTools 的编辑框 CodeMirror 里打开大文件，它会禁用部分高亮，因为CM编辑框每次移动光标都重生成整个网页树，你对单词增删时，它才只变更一行内容。很像VSCode利用 CSS transform 做的滚动

绝谛接受律C格式的语法定义，利用容错解析、按{} 增量解析同时完成分词和语法树的创建。 首次完整解析后得词条 `集<序号A~B: 词条类型> "span"` ，对每个区间 取字体外边框-填色长方形，生成高亮贴图遮罩。 鼠标下符号的功能，也是基于文字光标从span表获取

尽管绝谛靠单 textarea 就实现了VSCode用成千上万片元素拼出来的交互，span表和AST的频繁修改不可避。当你在{} 内增删，律C会只重解析最近一层{}内的语法并即地替换其AST。对 html,yml 内文字 span 如何复用旧结果？

把文件头尾说成左和右，如果在最右加字符，左部span都不用改，但在最左加3字，其右侧都要移3位。为了这类复用，绝谛引入了左闭右开“射线”叠成的 偏移表

`{abc}{def}` 现有两个成员AB， A删1字 其'}'右偏移+1 ，跳过因缩短被'}' 遮盖的c字

`{abc}wtf{def}` A增1字，其'}'右偏移-1 ，'w'被覆盖前 保留"wtf"，若光标偏移后<'}' 在保留的区表找

若A增4字，完全覆盖"wtf{" 会怎样？回看首例 `{abc}{def}`，A=i5+0 B=i10+0；`{ab}{def}` A=i4+1 B=i9+0 ，B的位置是依左浮标的i而定

`{abc}w{def}` i5+0, i11+0 增2字，变 `{abchh}w{def}` i7, i13 ，此时A右区间都已偏移+2 ，避免了B的增量解析覆盖右侧{}，并给A"w"1字的缓冲区

于是我们就收获了无论何时悬停，都能高亮光标AST项，且无需“碰撞检测”的动态高亮文本框。

除了有 .S .s 文本/二进制语法树， .dot 是SSA形式的ju代码，能够按滤镜图(无程控跳转箭头)编辑所有代码

书级只需改引用表； 物=框里的(构造变量+事 圆角折叠的分组)；以 hr->var 显示事里每量/ >10字的参数算式

重复/回 是根本的句级，若判空 都可包含它们。它们只是占1div、不可被hr指向。类似于逗句块 ，右键hr可内联/包裹/ 双击编辑外提

颜色|类型|有|
:--|:--|:--|
橙|str|浅=char 黄=Date等文本类|
绿|num|深=浮 浅=偏移|
红|bool|深=位旗,错误|
蓝|elem|浅=索引/单选 深=图画 紫=文件|

符号|类型|
:--|:--
+|列< V>
n|组< n次V>
?|V?
:|表<K,V>
\||可为<A,B>
横并列|储物
环并列|函事。如外绿心橙

- Sep(p,ws)
- Rep(p,pN=1, v0=Array,f=push)
- OpOrd(x,o,lev)
- KwTok(c/*trie*/)
- Indenty(x,{tab,chk(A,B)})
- Argsly(ks,let_body)
- `[a,':',b, Eqv((a,b)=>'0:0', s=>[0,0])]`
- `{kw:/\w+/, num:Sep(/\d+/, ',') }`
- `[{v:/\d+/, or:0, failTo:/;/}, parse]`
- Sur("[]",p)
构造
- sjs(['hi']).cat() 里[]{}Sep,.皆共享 `s=feed({set, tok,wsPre, ws:/*跳注释若st=0*/})`
- `Sep=(..)=>s=>(p=sjs(p), [dump=o=>, load=s=> ])`

```js
csv=Rep(Sep(/[^,]/, ','))
sexp=sjs.ref(p=>[{0:/\d+/, 1:/\w+/, 2:Sur("()",Rep(p)) }, Eqv.nthType(['number','string',x=>x.length]) ])()

di=(...k)=>({v:[...k,/[0-9]+/], or:0})
json=sjs.ref(v=>[{a:Sur("[]",Sep(v,',')),
  o:Sur("{}",Rep([k,v],[",",k,v], Object,(o,[k,v])=>(o[k]=v,o) )),
  var:{str, [di(/[+-]/), di('.'),di(/e/i,/[+-]/) ]},
  val:{1:"true",0:"false",2:"null"}}
]).ok()
```
