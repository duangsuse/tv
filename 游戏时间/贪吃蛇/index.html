<style>
.阵{display:grid; grid-template-columns:repeat(auto,var(--l)); overflow:hidden;resize:both}
.阵>hr{box-sizing:border-box; width:var(--l);height:var(--l); }
.阵>canvas,.阵>iframe{width:100%;height:100%;border:0}
</style><div>方块宽<b></b>：<input type=range min=5 max=50 step=5 value=25></div>
<script>
const doc=document, el=(e,k)=>e.appendChild(doc.createElement(k)), {random,floor:div}=Math
var e阵,n,m,阵, 模式,换阵=console.trace, g,hcon;//画布,文本输出
{
  let s=doc.location.hash.slice(1),e,l,fm; if(s)el(doc.head,"script").src=s//加载
  e=doc.querySelectorAll("b,input");//l&m 更新
  fm=()=>{ m=div(e阵.offsetWidth/l); n=div(e阵.offsetHeight/l); e[0].innerText=l+`列数${m}*行${n}`; 换阵(n*m)}
  new MutationObserver(fm).observe(e阵= el(doc.body,"div"), {attributes:true, attributeFilter:["style"]});//resize
  (e[1].onchange=ev=>{ l=e[1].valueAsNumber; fm() })()
}
{
  e阵.className="阵"
  let eOpt=el(doc.body.children[0],"select")
  "阵列grid 画布canvas 文本doc 阵列+平滑移动".split(" ").forEach(k=>{el(eOpt,"option").innerText=k})
  eOpt.onchange=ev=>{
    let i;模式=i=eOpt.selectedIndex;
    e阵.innerText=""
    if(i==0||i==3)换阵(n*m);
    else if(i==1)g=el(e阵,"canvas").getContext("2d");
    else if(i==2){
      let d=el(e阵,"iframe").contentDocument, fnt=`<style>body{white-space:pre;font: 20pt Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace;}</style>`
      hcon={clear(){d.write(fnt)/*文档流已关闭=清空*/}, w(s){d.write(s)}, wLn(){d.writeln()} }
    }
    e阵.style.r=i//更新
  }
}
</script>
